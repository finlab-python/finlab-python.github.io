(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{744:function(e,t,n){"use strict";n.r(t);n(54),n(75),n(23);var r=n(479),o=n(77),l=n(12),c=(n(43),n(74),n(148),n(429),n(192),n(39),n(53),n(30),n(64),n(6)),d=n(26),h=n(462),f=n(595),m=n(998),v=n(1043),k=n(827);Object(h.a)([m.a,v.a,k.a]);var y=Object(c.b)({name:"TreemapEcharts",data:function(){return{nameMapping:{return_ratio_1:"單日報酬",return_ratio_5:"週報酬",return_ratio_10:"10日報酬",return_ratio_20:"月報酬",close:"收盤價",vol_price:"價 x 量",market_value:"市值",volatility:"波動",boss_inv:"CEO佔比",rev_y_growth:"月營收年成長",rev_m_growth:"月營收月成長",cum_rev_y_growt:"累計月營收年成長",pe:"本益比",pb:"股價淨值比",dividend_yield:"殖利率",gross_margin:"毛利率",operating_margin:"營業利益率",roe:"股東權益報酬率",debt_ratio:"負債比率",chairman_inv:"股東佔比"},formatMapping:{"近一日報酬率":function(e){return(e>=0?"+"+e:e)+" %"},"近五日報酬率":function(e){return(e>=0?"+"+e:e)+" %"},"近十日報酬率":function(e){return(e>=0?"+"+e:e)+" %"},"近二十日報酬率":function(e){return(e>=0?"+"+e:e)+" %"},"收盤價":function(e){return e+" 元"},"成交金額":function(e){return e+" 千元"},"市值":function(e){return e+" 億"},"近十日真實波動率":function(e){return e+" %"},"集保四百張以上大戶持股占比":function(e){return e+" %"},"單月營收年增率":function(e){return(e>=0?"+"+e:e)+" %"},"單月營收月增率":function(e){return(e>=0?"+"+e:e)+" %"},"近十二月營收年增率":function(e){return(e>=0?"+"+e:e)+" %"},"殖利率":function(e){return(e>=0?"+"+e:e)+" %"},"營業利益率":function(e){return(e>=0?"+"+e:e)+" %"},"負債比率":function(e){return(e>=0?"+"+e:e)+" %"},"ROE稅後":function(e){return(e>=0?"+"+100*e:100*e)+" %"},"董監持股占比":function(e){return e+" %"}},colorRankingNames:[],colorRankingDisplayNames:[],selectedColorRanking:null,selectedAreaRanking:"資金流",industry:null,maxValues:[],minValues:[],tree:[],option:{toolbox:{top:0},tooltip:{formatter:function(e){for(var t=e.value,n=e.treePathInfo,r=[],i=1;i<n.length;i++)r.push(n[i].name);return['<div class="tooltip-title">'+r.join("/")+"</div>","Value: "+t].join("")}},series:[{name:"台股",top:0,left:0,right:0,bottom:0,width:"100%",height:"100%",type:"treemap",label:{show:!0,formatter:"{b}",color:"#333",lineHeight:20},leafDepth:2,itemStyle:{borderColor:"#f9f9fd"},breadcrumb:{top:0,left:0,position:"top"},visualDimension:1,visibleMin:1e3,roam:"move",zoomToNodeRatio:.3,levels:[{itemStyle:{borderColor:"#f9f9fd",borderWidth:0,gapWidth:2},upperLabel:{show:!1},textStyle:{color:"#333"}},{color:["#42bd91aa","#ffffff","#ff8985aa"],colorMappingBy:"value",itemStyle:{gapWidth:1,borderColor:"#f9f9fd",borderWidth:10},upperLabel:{show:!0,color:"#252786"},emphasis:{itemStyle:{borderColor:"#ddd"},upperLabel:{color:"#333"}}},{color:["#42bd91aa","#ffffff","#ff8985aa"],colorMappingBy:"value",itemStyle:{gapWidth:3}}],data:[]}]},chartInstance:null,resizeObserver:null}},mounted:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.initChart(),t.next=1,e.download();case 1:e.settingChart(),e.updateChart(),window.addEventListener("resize",e.resizeChart),"undefined"!=typeof ResizeObserver&&(e.resizeObserver=new ResizeObserver(function(){e.resizeChart()}),e.$refs.chart&&e.resizeObserver.observe(e.$refs.chart));case 2:case"end":return t.stop()}},t)}))()},beforeDestroy:function(){window.removeEventListener("resize",this.resizeChart),this.resizeObserver&&this.resizeObserver.disconnect(),this.chartInstance&&this.chartInstance.dispose()},methods:{initChart:function(){this.$refs.chart&&(this.chartInstance=Object(f.b)(this.$refs.chart,"light"))},resizeChart:function(){this.chartInstance&&this.chartInstance.resize()},updateChart:function(){this.chartInstance&&this.chartInstance.setOption(this.option,!0)},quantile:function(e){return(t=e,t.map(function(e,i){return[e,i]}).sort(function(a,b){return b[0]-a[0]}).map(function(a,i){return[].concat(Object(o.a)(a),[i+1])}).sort(function(a,b){return a[1]-b[1]}).map(function(a){return a[2]})).map(function(i){return 1-i/e.length});var t},settingChart:function(){var e=this;e.tree=[];var t=e.industry.ids,n=e.industry[e.selectedAreaRanking];console.log(e.industry),console.log("test area",e.selectedAreaRanking),console.log(n);var o=[],l=Object.keys(e.industry);l=l.filter(function(t){return!isNaN(e.industry[t][0])}),e.colorRankingNames=l;var c={};for(var d in e.colorRankingNames){var h=e.colorRankingNames[d];c[h]=this.quantile(this.industry[h])}console.log(c);for(var i=0;i<e.industry.ids.length;i+=1){var f=[];for(var m in f.push(n[i]),l){var v=c[l[m]][i];f.push(v)}f.push(i),o.push(f)}for(var k=[],y=0;y<e.industry.ids.length;y+=1)if(-1!==t[y].indexOf(" ")){var path=t[y].split("/");if(-1===k.indexOf(path[path.length-1])&&(k.push(path[path.length-1]),path.splice(-2),Object(r.a)("path"),void 0!==path[0]))for(var _ in e.insertNode(e.tree,path,o[y]),o[y]){var R=o[y][_];R>this.maxValues[_]?this.maxValues[_]=R:R<this.minValues[_]&&(this.minValues[_]=R)}}this.option.series[0].data=this.tree,this.selectedColorRanking="近一日報酬率",this.updateChart()},insertNode:function(e,path,t){var n=this.findChildID(e,path[0]);-1===n&&(n=e.length,e.push({name:path[0],value:[],children:[]})),path.shift(),0!=path.length?this.insertNode(e[n].children,path,t):e[n].value=t},findChildID:function(e,t){for(var n in e)if(e[n].name==t)return n;return-1},download:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark(function t(){var n,r,o,data,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("start render"),e.industryMode,e.featName,e.areaName,console.log("treemap start mount"),e.text=e.value,n=e,r=d.c.collection("twIndustryTest").doc("treemap"),t.next=1,r.get();case 1:if((o=t.sent).exists){t.next=2;break}return console.log("cannot find strategy menu"),t.abrupt("return");case 2:for(l in data=o.data(),console.log(data),data)data[l]=JSON.parse(data[l]);n.industry=data.supply_chain;case 3:case"end":return t.stop()}},t)}))()},setNodeName:function(e,t,n,r){if(0===e.children.length){var i=e.value[e.value.length-1],o=this.industry.ids[i].split("/").splice(-1)[0],l=this.industry[t][i],c=(t in this.nameMapping&&this.nameMapping[t],t in this.formatMapping?this.formatMapping[t](l):l);e.name=o.replace(" ","\n")+"\n"+c}for(var d in e.children)this.setNodeName(e.children[d],t,n,r)}},watch:{selectedColorRanking:function(){var e=this.colorRankingNames.indexOf(this.selectedColorRanking)+1;for(var t in this.option.series[0].visualDimension=e,this.option.series[0].data)this.setNodeName(this.option.series[0].data[t],this.selectedColorRanking,e,function(e){return e});this.option.series[0].visualMin=0,this.option.series[0].visualMax=1,this.updateChart()},selectedAreaRanking:function(){this.settingChart()}}}),_=n(52),component=Object(_.a)(y,function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"uk-container"},[t("div",{staticClass:"uk-text-left uk-margin",staticStyle:{"line-height":"5rem","vertical-align":"middle","font-size":"0.9rem"}},[e._v("\n    板塊大小代表：\n    "),t("label",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedAreaRanking,expression:"selectedAreaRanking"}],staticClass:"uk-radio",attrs:{type:"radio",name:"radio2",checked:""},domProps:{value:"資金流",checked:e._q(e.selectedAreaRanking,"資金流")},on:{change:function(t){e.selectedAreaRanking="資金流"}}}),e._v("\n      資金流")]),e._v(" "),t("label",{staticStyle:{"margin-right":"50px"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedAreaRanking,expression:"selectedAreaRanking"}],staticClass:"uk-radio",attrs:{type:"radio",name:"radio2"},domProps:{value:"市值",checked:e._q(e.selectedAreaRanking,"市值")},on:{change:function(t){e.selectedAreaRanking="市值"}}}),e._v("\n      市值")]),e._v("\n\n    顏色深淺代表：\n    "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedColorRanking,expression:"selectedColorRanking"}],staticClass:"uk-select uk-margin",staticStyle:{width:"200px","line-height":"1rem",background:"#ffffff33"},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.selectedColorRanking=t.target.multiple?n:n[0]}}},e._l(e.colorRankingNames,function(n){return t("option",{key:n,domProps:{value:n}},[e._v("\n        "+e._s(n in e.nameMapping?e.nameMapping[n]:n)+"\n      ")])}),0)]),e._v(" "),t("div",{staticStyle:{width:"100%",height:"600px","margin-top":"-1rem"}},[t("div",{ref:"chart",staticClass:"chart",staticStyle:{width:"100%",height:"100%"}})])])},[],!1,null,null,null);t.default=component.exports}}]);