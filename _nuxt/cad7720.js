(window.webpackJsonp=window.webpackJsonp||[]).push([[64,50],{1034:function(t,e,r){"use strict";r.r(e);r(74),r(54),r(75),r(192),r(39),r(23),r(38),r(45),r(68),r(61),r(69),r(148),r(60),r(53),r(30),r(44),r(284),r(40),r(194),r(64),r(198),r(285),r(286),r(287),r(288),r(289),r(290),r(291),r(292),r(293),r(294),r(295),r(296),r(297),r(298),r(299),r(300);var n=r(621),o=(r(622),r(623),r(624),r(637),r(6));function l(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,a){if(t){if("string"==typeof t)return c(t,a);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?c(t,a):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,l=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw l}}}}function c(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,r=Array(a);e<a;e++)r[e]=t[e];return r}var v={components:{codemirror:n.codemirror},props:["initStrategy","isLoading"],mounted:function(){null!==this.strategy.sorting.vid&&(this.showSorting=!0)},data:function(){return console.log("strategy prop",this.initStrategy),{strategy:o.a.util.extend({},this.initStrategy),code:"",showCode:!1,dragging:{vid:null},showSorting:!1,varGenerator:{show:!1,operations:[{name:"近期${n}筆平均",nickName:"均線",values:{n:20},func:"(${v}).rolling(${p.n}).mean()"},{name:"全市場排名百分比",nickName:"百分比",values:{},func:"(${v}).rank(axis=1, pct=True)"},{name:"計算 ${op} ${v2}",nickName:"運算",values:{op:["+",[{name:"+",value:"+"},{name:"-",value:"-"},{name:"*",value:"*"},{name:"/",value:"/"}]],v2:[0,"generateVarOption"]},func:"(${v} ${p.op} ${p.v2})"},{name:"計算 ${op} ${v2}",nickName:"運算",values:{op:["+",[{name:"+",value:"+"},{name:"-",value:"-"},{name:"*",value:"*"},{name:"/",value:"/"}]],v2:5},func:"(${v} ${p.op} ${p.v2})"},{name:"與前一筆做比較(%)",nickName:"變化量(%)",values:{},func:"(${v}).pct_change()"},{name:"前${n}筆數值",nickName:"前筆",values:{n:20},func:"(${v}).shift(${p.n})"},{name:"近期${n}筆的最大值",nickName:"MAX",values:{n:20},func:"(${v}).rolling(${p.n}).max()"},{name:"近期${n}筆的最小值",nickName:"MIN",values:{n:20},func:"(${v}).rolling(${p.n}).min()"}],state:[],dependencies:[],targetVar:null,vid:null,newVarName:""}}},methods:{setStrategy:function(s){this.strategy=s},callmethod:function(t){return this[t]()},generateVarOption:function(){return this.strategy.numVars.map(function(t,i){return{name:t.name,value:i}})},snippetStructure:function(t){var e=/(\$\{[a-zA-Z0-9_]+\})/g;return t.name.split(e).map(function(t){return t.match(e)?{value:t.slice(2,-1)}:{syntax:t}})},openVarGenerator:function(t,e,r){"var"===r&&("modification"===e&&null===this.strategy.numVars[t].generator||(this.varGenerator.show=!0,this.varGenerator.newVarName=this.strategy.numVars[t].name+"_改",this.varGenerator.targetVar=t,this.varGenerator.state=[],this.varGenerator.vid=null,"modification"===e&&(this.varGenerator.newVarName=this.strategy.numVars[t].name,this.varGenerator.state=this.strategy.numVars[t].generator.state,this.varGenerator.vid=t,this.varGenerator.targetVar=this.strategy.numVars[t].generator.targetVar)))},confirmVar:function(){var t=this.varGenerator,e=t.targetVar,r=t.state,n=t.newVarName,o=[e];for(var s in r)for(var l in r[s].value)Array.isArray(r[s].value[l])&&"generateVarOption"===r[s].value[l][1]&&o.push(r[s].value[l][0]);var c={name:n,varName:"var".concat(this.strategy.numVars.length),lines:null,type:"value",generator:{targetVar:e,state:r},deps:o};this.varGenerator.vid?this.strategy.numVars[this.varGenerator.vid]=c:this.strategy.numVars.push(c),this.varGenerator.state=[],this.varGenerator.targetVar=null,this.varGenerator.newVarName=null,this.$emit("onChangeStrategy",JSON.stringify(this.strategy))},calcNewVarName:function(){return this.varGenerator.targetVar},deleteVar:function(i){var t=new Set;t.add(parseInt(i));var e=this,r=function(i){var n=e.strategy.numVars;for(var o in n)if(null!==n[o=parseInt(o)].generator&&null!==n[o].generator.deps){var l=n[o].deps;for(var c in l)l[c]!==i||t.has(o)||(t.add(o),r(o))}};r(i);var n=new Set,o=this.strategy.boolVars;for(var l in o)"ineq"===o[l=parseInt(l)].type?("var"===o[l].ineq.eqLeftType&&t.has(o[l].ineq.eqLeft)||"var"===o[l].ineq.eqRightType&&t.has(o[l].ineq.eqRight))&&n.add(l):"numVar"===o[l].type&&t.has(o[l].vid)&&n.add(l);var c={},v=-1;for(var d in this.strategy.numVars)d=parseInt(d),t.has(d)||(v+=1),c[d]=v;for(var m in this.strategy.numVars){var f=this.strategy.numVars[m];if(null!==f.generator){for(var h in f.generator.targetVar=c[f.generator.targetVar],f.generator.state){var s=f.generator.state[h];for(var y in s.values){var k=s.values[y];Array.isArray(k)&&"generateVarOption"===k[1]&&(k[0]=c[k[0]])}}var _=[];for(var C in f.deps)_.push(c[f.deps[C]]);f.deps=_}}for(var V in this.strategy.boolVars){var b=this.strategy.boolVars[V];"ineq"===b.type?("var"===b.ineq.eqLeftType&&(b.ineq.eqLeft=c[b.ineq.eqLeft]),"var"===b.ineq.eqRightType&&(b.ineq.eqRight=c[b.ineq.eqRight])):"numVar"===b.type&&(b.vid=c[b.vid])}null!==this.strategy.sorting.target&&(this.strategy.sorting.target=c[this.strategy.sorting.target]),-1===this.strategy.sorting.target&&(this.strategy.sorting.target=null),this.strategy.numVars=this.strategy.numVars.filter(function(e,i){return!t.has(i)}),this.strategy.boolVars=this.strategy.boolVars.filter(function(t,i){return!n.has(i)}),this.$emit("onChangeStrategy",JSON.stringify(this.strategy))},addVarProcessName:function(t){this.varGenerator.state.push(JSON.parse(JSON.stringify(t))),"_改"==this.varGenerator.newVarName.slice(-2)&&(this.varGenerator.newVarName=this.varGenerator.newVarName.slice(0,-2)),this.varGenerator.newVarName+="_".concat(t.nickName)},addSortingTarget:function(){"bool"!==this.strategy.numVars[this.dragging.vid].type?this.strategy.sorting.target=this.dragging.vid:alert("此資料為布林訊號，無法排序！請選擇其他資料")},addCodeAndType:function(t){var e=t.code.split("\n");if("def "!==e[0].slice(0,4))if(-1===t.code.indexOf("sim")){var r,n=e[e.length-1],o=-1!==n.split("=")[0].indexOf(",");r=o?n.split("=")[0].replace(" ","").split(","):[n.split("=")[0].replace(" ","")];if("value"===t.type)this.strategy.numVars;else{if("bool"!==t.type)return void alert("錯誤：此生成程式碼型態為"+t.type+"而非 bool 或 value。");this.strategy.boolVars}var l=this.strategy.numVars.length;for(var i in r){var c=t.name.split("(")[0]+(o?"_".concat(r[i]):""),v=r[i],d=0==i?e:[],m=!1;for(var f in this.strategy.numVars){var h=this.strategy.numVars[f];if(h.name===c&&h.varName===v){m=!0;break}}m||this.strategy.numVars.push({name:c,type:t.type,varName:v,lines:d,generator:null,deps:0==i?[]:[l]})}this.$emit("onChangeStrategy",JSON.stringify(this.strategy))}else alert("目前無法處理策略！");else alert("目前無法處理函式！")},createCondition:function(){var t=this.dragging.vid;"value"===this.strategy.numVars[t].type?this.strategy.boolVars.push({type:"ineq",ineq:{eqLeft:this.dragging.vid,eqLeftType:"var",eqRight:0,eqRightType:"constant",eqOp:">"},setting:{period:1,satisfy:1}}):this.strategy.boolVars.push({type:"numVar",vid:t,setting:{period:1,satisfy:1}}),this.dragging.vid=null,this.$emit("onChangeStrategy",JSON.stringify(this.strategy))},dragstart:function(t){this.dragging.vid=t},generateCode:function(){this.$emit("onChangeStrategy",JSON.stringify(this.strategy));var t,code=["from finlab import data, backtest","","# 計算變數"],e=this.strategy.numVars,r=function(t){var r={};for(var n in t)Array.isArray(t[n])?"generateVarOption"===t[n][1]?r[n]=e[t[n][0]].varName:r[n]=t[n][0]:r[n]=t[n];return r},n=l(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;if(code.push("print('計算「".concat(o.name,"」')")),o.lines)code=code.concat(o.lines);else{var g=o.generator,c="".concat(o.varName," = ")+g.state.reduce(function(t,e){return(n=e.func,new Function(["v","p"],"return `".concat(n,"`;")))(t,r(e.values));var n},this.strategy.numVars[g.targetVar].varName);code=code.concat(c.split("\n"))}}}catch(t){n.e(t)}finally{n.f()}var v=this.strategy.boolVars;code=code.concat(["","","# 計算條件123"]);var d,m=0,f=l(v);try{for(f.s();!(d=f.n()).done;){var b=d.value;if(code.push("print('計算條件".concat(m,"')")),"ineq"===b.type){var h="var"===b.ineq.eqLeftType?e[b.ineq.eqLeft].varName:b.ineq.eqLeft,y="var"===b.ineq.eqRightType?e[b.ineq.eqRight].varName:b.ineq.eqRight;1!=b.setting.satisfy||1!=b.setting.period?code.push("condition_".concat(m," = (").concat(h," ").concat(b.ineq.eqOp," ").concat(y,").sustain(").concat(b.setting.period,", ").concat(b.setting.satisfy,")")):code.push("condition_".concat(m," = ").concat(h," ").concat(b.ineq.eqOp," ").concat(y))}else"numVar"===b.type&&code.push("condition_".concat(m," = ").concat(e[b.vid].varName));m+=1}}catch(t){f.e(t)}finally{f.f()}(code=code.concat(["","","# 交集所有條件"])).push("print('交集所有條件')");for(var k="all_conditions = ",i=0;i<m;i+=1)k+="condition_".concat(i),i!==m-1&&(k+=" & ");if(code.push(k),null!==this.strategy.sorting.target){(code=code.concat(["","","# 排序選取"])).push("print('股票進行排序')");var _=this.strategy.sorting,C=_.target,V=_.type,x=_.topn;code.push("all_conditions = ".concat(e[C].varName,".index_str_to_date()[all_conditions].is_").concat(V,"(").concat(x,")"))}(code=code.concat(["","","# 回測"])).push("print('回測中')"),code.push("from finlab.backtest import sim");var w=this.strategy.backtest,N=w.resample,S=w.stop_loss,$=w.take_profit,G=w.position_limit,A=w.trade_at_price;return code.push("backtest.sim(all_conditions,\n"+("None"===N?"  resample=None,\n":"  resample='".concat(N,"',\n"))+(S?"  stop_loss=".concat(S/100,",\n"):"")+($?"  take_profit=".concat($/100,",\n"):"")+(G?"  position_limit=".concat(G/100,",\n"):"")+"  trade_at_price='".concat(A,"'")+")"),code.push("print('回測順利結束')"),this.code=code.join("\n"),this.code}},watch:{initStrategy:function(){},strategy:{handler:function(){console.log("emit!!!"),this.$emit("onChangeStrategy",JSON.stringify(this.strategy))},deep:!0}}},d=(r(979),r(980),r(52)),component=Object(d.a)(v,function(){var t=this,e=t._self._c;return e("div",[e("div",[e("div",[e("div",{staticClass:"uk-margin-large-left"},[e("div",{staticClass:"uk-margin-large-bottom"},[e("div",{staticClass:"uk-card uk-padding-small uk-text-center small-radius",staticStyle:{position:"relative",border:"1px solid #bbb"}},[0===t.strategy.numVars.length?e("div",{staticClass:"uk-text-muted"},[e("h4",[t._v("數據")]),t._v("\n              請從右側插入數據\n            ")]):e("div",{staticClass:"uk-grid-small uk-grid-divider",attrs:{"uk-grid":""}},[t._m(0),t._v(" "),e("div",{staticClass:"uk-width-expand"},[e("div",{staticClass:"uk-flex uk-flex-wrap uk-flex-wrap-around",style:"margin-bottom: -0.6rem"},t._l(t.strategy.numVars,function(r,n){return e("div",{key:"numVar-".concat(r.name),staticClass:"uk-card var shadow uk-text-middle uk-margin-bottom uk-margin-right",staticStyle:{cursor:"grab"},attrs:{draggable:"true",id:"vid-".concat(n)},on:{dragstart:function(e){return t.dragstart(n)}}},[e("span",{staticClass:"uk-text-small",on:{click:function(e){return t.openVarGenerator(n,"modification","var")}}},[t._v(t._s(r.name)+"\n                    ")]),t._v(" "),e("a",{staticClass:"uk-icon-button",attrs:{"uk-icon":"icon: plus; ratio: 0.8"},on:{click:[function(e){return t.openVarGenerator(n,"insertion","var")},function(t){t.stopPropagation()}]}})])}),0)])]),t._v(" "),t.strategy.numVars.length>0?e("span",{staticClass:"uk-icon-button",staticStyle:{position:"absolute",bottom:"14px",right:"14px",color:"#ccc",background:"white",border:"0",cursor:"auto"},attrs:{"uk-icon":"icon: minus-circle; ratio: 3"},on:{drop:function(e){return t.deleteVar(t.dragging.vid)},dragover:function(t){t.preventDefault()},dragenter:function(t){t.preventDefault()}}}):t._e()]),t._v(" "),e("Modal",{staticClass:"uk-text-left",attrs:{title:"計算數據",confirm:t.confirmVar},model:{value:t.varGenerator.show,callback:function(e){t.$set(t.varGenerator,"show",e)},expression:"varGenerator.show"}},[e("div",[e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.varGenerator.newVarName,expression:"varGenerator.newVarName"}],staticClass:"uk-input uk-margin-bottom",attrs:{type:"text"},domProps:{value:t.varGenerator.newVarName},on:{input:function(e){e.target.composing||t.$set(t.varGenerator,"newVarName",e.target.value)}}}),t._v(" "),0!==t.varGenerator.state.length?e("div",{staticClass:"uk-flex small-radius uk-padding-small uk-margin-bottom uk-text-small",staticStyle:{background:"#00000011"}},[e("div",[t._v("\n                    解釋："+t._s(t.strategy.numVars[t.varGenerator.targetVar]?t.strategy.numVars[t.varGenerator.targetVar].name:t.varGenerator.targetVar)+"\n                  ")]),t._v(" "),e("div",{staticClass:"uk-width-expand"},t._l(t.varGenerator.state,function(r,i){return e("div",[e("div",{staticClass:"uk-clearfix"},[e("div",{staticClass:"uk-float-left"},[t._v("的\n                          "),t._l(t.snippetStructure(r),function(n,o){return e("span",{key:"snippet".concat(r.name,"_").concat(o)},[Array.isArray(r.values[n.value])?e("select",{directives:[{name:"model",rawName:"v-model",value:r.values[n.value][0],expression:"subsnip.values[o.value][0]"}],staticClass:"parameter",staticStyle:{background:"transparent"},on:{click:function(t){t.stopPropagation()},change:function(e){var o=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(r.values[n.value],0,e.target.multiple?o:o[0])}}},[Array.isArray(r.values[n.value][1])?t._l(r.values[n.value][1],function(r){return e("option",{domProps:{value:r.value}},[t._v(t._s(r.name)+"\n                                ")])}):t._l(t.callmethod(r.values[n.value][1]),function(r){return e("option",{domProps:{value:r.value}},[t._v(t._s(r.name)+"\n                                ")])})],2):"value"in n?e("input",{directives:[{name:"model",rawName:"v-model",value:r.values[n.value],expression:"subsnip.values[o.value]"}],staticClass:"parameter",attrs:{type:"text"},domProps:{value:r.values[n.value]},on:{click:function(t){t.stopPropagation()},input:function(e){e.target.composing||t.$set(r.values,n.value,e.target.value)}}}):[t._v(" "+t._s(n.syntax))]],2)})],2),t._v(" "),e("div",{staticClass:"uk-float-right"},[e("span",{staticStyle:{cursor:"pointer"},attrs:{"uk-icon":"icon: close; ratio: 0.8"},on:{click:function(e){return t.varGenerator.state.splice(i,1)}}})])])])}),0)]):t._e()]),t._v(" "),e("div",{staticClass:"uk-flex uk-flex-wrap uk-flex-wrap-around uk-margin-large-top"},t._l(t.varGenerator.operations,function(r){return e("div",{staticClass:"uk-margin-bottom uk-margin-right"},[e("div",{staticClass:"uk-button uk-button-default uk-button-small uk-background-default",staticStyle:{background:"#00000011"},on:{click:function(e){return t.addVarProcessName(r)}}},t._l(t.snippetStructure(r),function(n,o){return e("span",{key:"snippet".concat(r.name,"_").concat(o)},[Array.isArray(r.values[n.value])?e("select",{directives:[{name:"model",rawName:"v-model",value:r.values[n.value][0],expression:"subsnip.values[o.value][0]"}],staticClass:"parameter",staticStyle:{background:"transparent"},on:{click:function(t){t.stopPropagation()},change:function(e){var o=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(r.values[n.value],0,e.target.multiple?o:o[0])}}},[Array.isArray(r.values[n.value][1])?t._l(r.values[n.value][1],function(r){return e("option",{domProps:{value:r.value}},[t._v(t._s(r.name))])}):t._l(t.callmethod(r.values[n.value][1]),function(r){return e("option",{domProps:{value:r.value}},[t._v(t._s(r.name)+"\n                          ")])})],2):"value"in n?e("input",{directives:[{name:"model",rawName:"v-model",value:r.values[n.value],expression:"subsnip.values[o.value]"}],staticClass:"parameter",attrs:{type:"text"},domProps:{value:r.values[n.value]},on:{click:function(t){t.stopPropagation()},input:function(e){e.target.composing||t.$set(r.values,n.value,e.target.value)}}}):[t._v(" "+t._s(n.syntax))]],2)}),0)])}),0)])])],1),t._v(" "),e("div",{staticClass:"small-radius uk-padding-small uk-margin-large-bottom",staticStyle:{border:"1px solid #bbb"},on:{drop:t.createCondition,dragover:function(t){t.preventDefault()},dragenter:function(t){t.preventDefault()}}},[0===t.strategy.boolVars.length?e("div",{staticClass:"uk-text-center uk-text-muted"},[e("h4",[t._v("條件")]),t._v("\n            從上方將數據拖入\n          ")]):e("div",{staticClass:"uk-grid-small uk-grid-divider",attrs:{"uk-grid":""}},[t._m(1),t._v(" "),e("div",{staticClass:"uk-width-expand"},t._l(t.strategy.boolVars,function(b,i){return e("div",{key:"bool-var-".concat(i)},[e("div",{staticClass:"uk-text-small uk-grid-collapse",attrs:{"uk-grid":""}},["ineq"===b.type?e("div",{staticClass:"uk-width-auto"},[e("div",{staticClass:"uk-flex uk-flex-middle uk-background-default small-radius shadow",class:{"uk-margin-bottom":i!==t.strategy.boolVars.length-1}},[e("div",{staticClass:"boolVar",on:{drop:[function(e){b.ineq.eqLeft=t.dragging.vid,b.ineq.eqLeftType="var"},function(t){t.stopPropagation()}],dragover:function(t){t.preventDefault()},dragenter:function(t){t.preventDefault()},click:function(e){return t.openVarGenerator(b.ineq.eqLeft,"modification",b.ineq.eqLeftType)}}},[t._v(t._s(t.strategy.numVars[b.ineq.eqLeft]?t.strategy.numVars[b.ineq.eqLeft].name:b.ineq.eqLeft))]),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:b.ineq.eqOp,expression:"b.ineq.eqOp"}],staticClass:"uk-select uk-form-large uk-form-width-xsmall",staticStyle:{"text-align":"center","border-top":"0","border-bottom":"0"},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(b.ineq,"eqOp",e.target.multiple?r:r[0])}}},t._l({">":">","≥":">=","=":"==","≤":"<=","<":"<"},function(r,n){return e("option",{domProps:{value:r}},[t._v(t._s(n))])}),0),t._v(" "),e("div",{staticClass:"boolVar",on:{drop:[function(e){b.ineq.eqRight=t.dragging.vid,b.ineq.eqRightType="var"},function(t){t.stopPropagation()}],dragover:function(t){t.preventDefault()},dragenter:function(t){t.preventDefault()},click:function(e){return t.openVarGenerator(b.ineq.eqRight,"modification",b.ineq.eqRightType)}}},["var"===b.ineq.eqRightType?e("span",[t._v("\n                          "+t._s(t.strategy.numVars[b.ineq.eqRight]?t.strategy.numVars[b.ineq.eqRight].name:b.ineq.eqRight))]):e("input",{directives:[{name:"model",rawName:"v-model",value:b.ineq.eqRight,expression:"b.ineq.eqRight"}],staticClass:"parameter",attrs:{type:"text"},domProps:{value:b.ineq.eqRight},on:{input:function(e){e.target.composing||t.$set(b.ineq,"eqRight",e.target.value)}}})])])]):e("div",{staticClass:"uk-background-default small-radius shadow boolVar uk-width-auto",class:{"uk-margin-bottom":i!==t.strategy.boolVars.length-1}},[t._v("\n                    "+t._s(t.strategy.numVars[b.vid]?t.strategy.numVars[b.vid].name:b.vid)+"\n                  ")]),t._v(" "),e("div",{staticClass:"uk-width-expand"}),t._v(" "),e("div",{staticClass:"uk-width-auto uk-flex uk-flex-middle"},[1!=b.setting.period||1!=b.setting.satisfy?e("div",{staticClass:"uk-text-small uk-margin-right"},[t._v("\n                      近期滿足 "+t._s(b.setting.satisfy)+" / "+t._s(b.setting.period)+" 筆\n                    ")]):t._e(),t._v(" "),e("a",{staticClass:"uk-icon-button",staticStyle:{border:"5px solid #f0f0fa"},attrs:{"uk-icon":"icon: more; ratio: 0.8"},on:{click:function(t){t.stopPropagation()}}}),t._v(" "),e("div",{staticClass:"uk-card uk-padding-small uk-background-default small-radius shadow",attrs:{"uk-drop":"animation: slide-top; animate-out: true;pos: bottom-center;mode: click"}},[t._v("\n                      近期 "),e("input",{directives:[{name:"model",rawName:"v-model",value:b.setting.period,expression:"b.setting.period"}],staticClass:"parameter",attrs:{type:"text"},domProps:{value:b.setting.period},on:{input:function(e){e.target.composing||t.$set(b.setting,"period",e.target.value)}}}),t._v("\n                      筆當中滿足 "),e("input",{directives:[{name:"model",rawName:"v-model",value:b.setting.satisfy,expression:"b.setting.satisfy"}],staticClass:"parameter",attrs:{type:"text"},domProps:{value:b.setting.satisfy},on:{input:function(e){e.target.composing||t.$set(b.setting,"satisfy",e.target.value)}}}),t._v(" 筆\n                    ")]),t._v(" "),e("div",{staticClass:"uk-margin-left",on:{click:function(e){return t.strategy.boolVars.splice(i,1)}}},[e("a",{staticClass:"uk-icon-button",staticStyle:{border:"5px solid #f0f0fa"},attrs:{"uk-icon":"icon: close; ratio: 0.8"}})])])])])}),0)])]),t._v(" "),e("div",{staticClass:"small-radius uk-padding-small dark-muted",staticStyle:{border:"1px solid #bbb"},on:{drop:t.addSortingTarget,dragover:function(t){t.preventDefault()},dragenter:function(t){t.preventDefault()}}},[null===t.strategy.sorting.target?e("div",{staticClass:"uk-text-muted uk-text-center"},[e("h4",[t._v("排序\n            ")]),t._v("\n            請從最上方拖入數據\n          ")]):e("div",{staticClass:"uk-grid-small uk-grid-divider",attrs:{"uk-grid":""}},[t._m(2),t._v(" "),e("div",[e("div",{staticClass:"uk-flex uk-flex-middle uk-text-small"},[t._v("\n\n                "+t._s(t.strategy.numVars[t.strategy.sorting.target].name)+"\n                "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.strategy.sorting.type,expression:"strategy.sorting.type"}],staticClass:"uk-select uk-form-width-xsmall uk-text-small",on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.strategy.sorting,"type",e.target.multiple?r:r[0])}}},t._l([{name:"最大",value:"largest"},{name:"最小",value:"smallest"}],function(r){return e("option",{domProps:{value:r.value}},[t._v(t._s(r.name))])}),0),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.strategy.sorting.topn,expression:"strategy.sorting.topn"}],staticClass:"uk-input uk-width-small",attrs:{type:"number"},domProps:{value:t.strategy.sorting.topn},on:{input:function(e){e.target.composing||t.$set(t.strategy.sorting,"topn",e.target.value)}}}),t._v("\n                檔\n                "),e("div",{staticClass:"uk-margin-left",on:{click:function(e){t.strategy.sorting.target=null}}},[e("a",{staticClass:"uk-icon-button",staticStyle:{border:"5px solid #f0f0fa"},attrs:{"uk-icon":"icon: close; ratio: 0.8"}})])])])])]),t._v(" "),e("h4"),t._v(" "),e("div",{staticClass:"small-radius dark-muted uk-text-middle uk-padding-small uk-text-small uk-margin-large-bottom",staticStyle:{border:"1px solid #bbb"}},[e("div",{staticClass:"uk-grid-small uk-grid-divider",attrs:{"uk-grid":""}},[t._m(3),t._v(" "),e("div",[e("div",{staticClass:"uk-margin-bottom uk-flex uk-flex-middle"},[t._v("\n                新的清單產生於\n                "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.strategy.backtest.resample,expression:"strategy.backtest.resample"}],staticClass:"uk-select uk-form-width-small",on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.strategy.backtest,"resample",e.target.multiple?r:r[0])}}},t._l([{name:"當清單變化時",value:"None"},{name:"每日",value:"D"},{name:"每週末",value:"W"},{name:"每月底",value:"M"},{name:"每季底",value:"Q"}],function(r){return e("option",{domProps:{value:r.value}},[t._v(t._s(r.name))])}),0),t._v("\n\n                的下個交易日\n\n                "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.strategy.backtest.trade_at_price,expression:"strategy.backtest.trade_at_price"}],staticClass:"uk-select uk-form-width-xsmall",on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.strategy.backtest,"trade_at_price",e.target.multiple?r:r[0])}}},t._l([{name:"開盤",value:"open"},{name:"收盤",value:"close"}],function(r){return e("option",{domProps:{value:r.value}},[t._v(t._s(r.name))])}),0),t._v("\n\n                換股\n              ")]),t._v(" "),"D"!==t.strategy.backtest.resample?e("div",{staticClass:"uk-flex uk-flex-middle"},[t._v("\n                停損\n                "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.strategy.backtest.stop_loss,expression:"strategy.backtest.stop_loss"}],staticClass:"uk-input uk-form-width-xsmall",attrs:{type:"text",placeholder:"無"},domProps:{value:t.strategy.backtest.stop_loss},on:{input:function(e){e.target.composing||t.$set(t.strategy.backtest,"stop_loss",e.target.value)}}}),t._v("%\n                "),e("span",{staticClass:"uk-margin-large-left"},[t._v("停利")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.strategy.backtest.take_profit,expression:"strategy.backtest.take_profit"}],staticClass:"uk-input uk-form-width-xsmall",attrs:{type:"text",placeholder:"無"},domProps:{value:t.strategy.backtest.take_profit},on:{input:function(e){e.target.composing||t.$set(t.strategy.backtest,"take_profit",e.target.value)}}}),t._v("%\n\n                "),e("span",{staticClass:"uk-margin-large-left"},[t._v("個股最大部位：")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.strategy.backtest.position_limit,expression:"strategy.backtest.position_limit"}],staticClass:"uk-input uk-form-width-xsmall",attrs:{type:"text",placeholder:"無"},domProps:{value:t.strategy.backtest.position_limit},on:{input:function(e){e.target.composing||t.$set(t.strategy.backtest,"position_limit",e.target.value)}}}),t._v("%\n              ")]):t._e()])])]),t._v(" "),e("button",{staticClass:"uk-button-large uk-button-primary",attrs:{disabled:t.isLoading},on:{click:function(e){t.$emit("backtest",t.generateCode())}}},[t._v("驗證策略"),t.isLoading?e("div",{staticClass:"uk-margin-left",attrs:{"uk-spinner":""}}):t._e()]),t._v(" "),e("button",{staticClass:"uk-button-large uk-button-default",on:{click:function(e){t.generateCode(),t.showCode=!0}}},[t._v("產生程式碼")]),t._v(" "),e("Modal",{model:{value:t.showCode,callback:function(e){t.showCode=e},expression:"showCode"}},[e("codemirror",{ref:"cmEditor",attrs:{options:{autofocus:!0,tabSize:2,mode:"python",lineNumbers:!0,theme:"idle",line:!0,autoCloseBrackets:!0,scrollbarStyle:null,viewportMargin:1/0}},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1)],1)])])])},[function(){var t=this._self._c;return t("div",{staticClass:"uk-width-auto"},[t("h4",{staticClass:"uk-margin-right"},[this._v("\n                  數據\n                ")])])},function(){var t=this._self._c;return t("div",{staticClass:"uk-width-auto"},[t("h4",{staticClass:"uk-margin-right"},[this._v("\n                條件\n              ")])])},function(){var t=this._self._c;return t("div",{staticClass:"uk-width-auto"},[t("h4",{staticClass:"uk-margin-right"},[this._v("排序")])])},function(){var t=this._self._c;return t("div",{staticClass:"uk-width-auto"},[t("h4",{staticClass:"uk-margin-right"},[this._v("回測")])])}],!1,null,"10db207b",null);e.default=component.exports;installComponents(component,{Modal:r(534).default})},534:function(t,e,r){"use strict";r.r(e);var n={props:{confirm:{default:null},title:{default:null},value:{default:!1}},methods:{confirmClose:function(){this.confirm&&this.confirm(),this.hide()},hide:function(){this.$emit("input",!1)}}},o=r(52),component=Object(o.a)(n,function(){var t=this,e=t._self._c;return e("div",{staticClass:"uk-modal uk-open",style:t.value?"display: initial":""},[e("div",{staticClass:"uk-modal-dialog",staticStyle:{"border-radius":"15px",overflow:"hidden"}},[e("button",{staticClass:"uk-modal-close-default",attrs:{type:"button","uk-close":""},on:{click:t.hide}}),t._v(" "),t.title?e("div",{staticClass:"uk-modal-header"},[e("h2",{staticClass:"uk-modal-title uk-text-primary"},[t._v(t._s(t.title))])]):t._e(),t._v(" "),e("div",{staticClass:"uk-modal-body"},[t._t("default")],2),t._v(" "),e("div",{staticClass:"uk-modal-footer uk-text-right"},[t.confirm?e("button",{staticClass:"uk-button uk-button-default",attrs:{type:"button"},on:{click:t.hide}},[t._v("取消")]):t._e(),t._v(" "),e("button",{staticClass:"uk-button uk-button-primary",attrs:{type:"button"},on:{click:t.confirmClose}},[t._v("確定")])])])])},[],!1,null,null,null);e.default=component.exports},637:function(t,e,r){t.exports={}},819:function(t,e,r){t.exports={}},820:function(t,e,r){t.exports={}},979:function(t,e,r){"use strict";r(819)},980:function(t,e,r){"use strict";r(820)}}]);