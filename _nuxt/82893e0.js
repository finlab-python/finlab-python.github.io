(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{1001:function(t,e,n){"use strict";n.r(e);n(74),n(54),n(75),n(60),n(23);var r=n(12),o=(n(43),n(6)),c=n(26),l=n(750),d=n.n(l),m=Object(o.b)({components:{VueTagsInput:d.a},setup:function(){},watchQuery:["cid"],data:function(){return{cid:this.$route.query.cid||null,title:"",thumbnail:"",src:"",date:(new Date).toISOString().split("T")[0],author:"",tags:[],sid:"",permission:0,display:!1,processing:!1,tag:""}},mounted:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark(function e(){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.cid){e.next=1;break}return e.abrupt("return");case 1:return e.prev=1,e.next=2,c.c.collection("courses").doc(t.cid).get();case 2:n=e.sent.data(),t.title=n.title,t.thumbnail=n.thumbnail,t.date=n.date,t.src=n.src,t.$refs.postPanel.post=n.post,t.author=n.author,t.tags=n.tags,t.sid=n.sid,t.permission=n.permission,t.display=n.display,e.next=4;break;case 3:e.prev=3,r=e.catch(1),t.cid=null,alert(r),console.log(r);case 4:case"end":return e.stop()}},e,null,[[1,3]])}))()},methods:{upload:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark(function e(){var n,r,o,menu;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.processing=!0,n={title:t.title,src:t.src,thumbnail:t.thumbnail,post:t.$refs.postPanel.post,date:t.date,author:t.author,tags:t.tags,sid:t.sid,permission:t.permission,display:t.display},console.log("upload obj"),console.log(n),!t.cid){e.next=2;break}return e.next=1,c.c.collection("courses").doc(t.cid).set(n);case 1:e.next=4;break;case 2:return e.next=3,c.c.collection("courses").add(n);case 3:r=e.sent,t.cid=r.id;case 4:return o={cid:t.cid,title:t.title,thumbnail:t.thumbnail,author:t.author,date:t.date,tags:t.tags,sid:t.sid,permission:t.permission,display:t.display},(menu={})[t.cid]=o,e.next=5,c.c.collection("courses").doc("menu").set(menu,{merge:!0});case 5:window.history.pushState({},null,window.location.href.split("?")[0]+"?cid="+t.cid),t.processing=!1;case 6:case"end":return e.stop()}},e)}))()},del:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark(function e(){var menu;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t.cid){e.next=1;break}return e.abrupt("return");case 1:return e.next=2,c.c.collection("courses").doc(t.vid).delete();case 2:return e.next=3,c.c.collection("courses").doc("menu").get();case 3:delete(menu=e.sent.data())[t.cid],c.c.collection("courses").doc("menu").set(menu),window.history.pushState({},null,window.location.href.split("?")[0]);case 4:case"end":return e.stop()}},e)}))()}}}),v=n(52),component=Object(v.a)(m,function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e("div",{staticClass:"uk-section"},[e("div",{staticClass:"uk-container"},[e("h1",[t._v("影片"+t._s(t.cid?"設定":"新增"))])])]),t._v(" "),e("div",{staticClass:"uk-section uk-section-default"},[e("div",{staticClass:"uk-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.date,expression:"date"}],attrs:{type:"date",id:"start"},domProps:{value:t.date},on:{input:function(e){e.target.composing||(t.date=e.target.value)}}}),t._v(" "),e("div",{staticClass:"uk-margin"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"uk-input",attrs:{type:"text",placeholder:"影片名稱"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}})]),t._v(" "),e("div",{staticClass:"uk-margin"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.author,expression:"author"}],staticClass:"uk-input",attrs:{type:"text",placeholder:"作者"},domProps:{value:t.author},on:{input:function(e){e.target.composing||(t.author=e.target.value)}}})]),t._v(" "),e("div",{staticClass:"uk-margin"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.thumbnail,expression:"thumbnail"}],staticClass:"uk-input",attrs:{type:"text",placeholder:"縮圖網址"},domProps:{value:t.thumbnail},on:{input:function(e){e.target.composing||(t.thumbnail=e.target.value)}}})]),t._v(" "),e("div",{staticClass:"uk-margin"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.src,expression:"src"}],staticClass:"uk-input",attrs:{type:"text",placeholder:"影片連結"},domProps:{value:t.src},on:{input:function(e){e.target.composing||(t.src=e.target.value)}}})]),t._v(" "),e("div",{staticClass:"uk-margin"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.sid,expression:"sid"}],staticClass:"uk-input",attrs:{type:"text",placeholder:"策略名稱 SID"},domProps:{value:t.sid},on:{input:function(e){e.target.composing||(t.sid=e.target.value)}}})]),t._v(" "),e("div",{staticClass:"uk-margin"},[e("vue-tags-input",{attrs:{tags:t.tags},on:{"tags-changed":function(e){return t.tags=e}},model:{value:t.tag,callback:function(e){t.tag=e},expression:"tag"}})],1),t._v(" "),e("div",{staticClass:"uk-margin"},[e("div",{staticClass:"uk-form-controls"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.permission,expression:"permission"}],staticClass:"uk-select",attrs:{id:"form-stacked-select"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.permission=e.target.multiple?n:n[0]}}},[e("option",{domProps:{value:0}},[t._v("所有用戶")]),t._v(" "),e("option",{domProps:{value:1}},[t._v("登入用戶")]),t._v(" "),e("option",{domProps:{value:2}},[t._v("VIP 月方案")]),t._v(" "),e("option",{domProps:{value:3}},[t._v("VIP 年方案")])])]),t._v("\n        "+t._s(t.permission)+"\n      ")]),t._v(" "),e("div",{staticClass:"uk-margin uk-grid-small uk-child-width-auto uk-grid"},[e("label",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.display,expression:"display"}],staticClass:"uk-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.display)?t._i(t.display,null)>-1:t.display},on:{change:function(e){var n=t.display,r=e.target,o=!!r.checked;if(Array.isArray(n)){var c=t._i(n,null);r.checked?c<0&&(t.display=n.concat([null])):c>-1&&(t.display=n.slice(0,c).concat(n.slice(c+1)))}else t.display=o}}}),t._v("\n          顯示影片")])]),t._v(" "),e("LazyPostPanel",{ref:"postPanel"}),t._v(" "),e("div",{staticClass:"uk-margin"},[e("button",{staticClass:"uk-button uk-button-primary",on:{click:t.upload}},[t._v("\n          "+t._s(t.processing?"上傳中":"儲存")+"\n        ")]),t._v(" "),t.cid?e("button",{staticClass:"uk-button uk-button-danger",on:{click:t.del}},[t._v("\n          刪除\n        ")]):t._e()])],1)])])},[],!1,null,null,null);e.default=component.exports}}]);