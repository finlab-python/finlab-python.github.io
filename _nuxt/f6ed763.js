(window.webpackJsonp=window.webpackJsonp||[]).push([[26,21,22,37],{431:function(e,t,n){"use strict";var o=n(5),r=n(8),l=n(55),c=n(50),d=n(76),m=n(274),f=n(24),_=n(9),y=n(275),h=n(190),v=n(440),C=n(441),k=n(120),D=n(442),O=[],R=r(O.sort),E=r(O.push),I=_(function(){O.sort(void 0)}),T=_(function(){O.sort(null)}),A=h("sort"),x=!_(function(){if(k)return k<70;if(!(v&&v>3)){if(C)return!0;if(D)return D<603;var code,e,t,n,o="";for(code=65;code<76;code++){switch(e=String.fromCharCode(code),code){case 66:case 69:case 70:case 72:t=3;break;case 68:case 71:t=4;break;default:t=2}for(n=0;n<47;n++)O.push({k:e+n,v:t})}for(O.sort(function(a,b){return b.v-a.v}),n=0;n<O.length;n++)e=O[n].k.charAt(0),o.charAt(o.length-1)!==e&&(o+=e);return"DGBEFHACIJK"!==o}});o({target:"Array",proto:!0,forced:I||!T||!A||!x},{sort:function(e){void 0!==e&&l(e);var t=c(this);if(x)return void 0===e?R(t):R(t,e);var n,o,r=[],_=d(t);for(o=0;o<_;o++)o in t&&E(r,t[o]);for(y(r,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:f(t)>f(n)?1:-1}}(e)),n=d(r),o=0;o<n;)t[o]=r[o++];for(;o<_;)m(t,o++);return t}})},440:function(e,t,n){"use strict";var o=n(85).match(/firefox\/(\d+)/i);e.exports=!!o&&+o[1]},441:function(e,t,n){"use strict";var o=n(85);e.exports=/MSIE|Trident/.test(o)},442:function(e,t,n){"use strict";var o=n(85).match(/AppleWebKit\/(\d+)\./);e.exports=!!o&&+o[1]},540:function(e,t,n){e.exports={}},551:function(e,t,n){"use strict";n.r(t);var o=n(618),r=n.n(o),l={name:"BlocklyComponent",props:["options","value","height"],data:function(){return{workspace:null,initialValue:this.$props.value}},mounted:function(){console.log("start mounted component");var e=this.$props.options||{};e.toolbox||(e.toolbox=this.$refs.blocklyToolbox),this.workspace=r.a.inject(this.$refs.blocklyDiv,e);var t=r.a.Xml.textToDom(this.initialValue);r.a.Xml.domToWorkspace(t,this.workspace),console.log("end mounted component")},methods:{injectCode:function(e){var t=r.a.Xml.textToDom(e);this.workspace.clear(),r.a.Xml.domToWorkspace(t,this.workspace)},injectAdditionCode:function(e){var t=r.a.Xml.textToDom(e);console.log("blockly component get xml",t),r.a.Xml.domToWorkspace(t,this.workspace)},getCode:function(){var e=r.a.Xml.workspaceToDom(this.workspace);return r.a.Xml.domToText(e)}},beforeDestroy:function(){var code=this.getCode();this.$emit("input",code)}},c=(n(571),n(52)),component=Object(c.a)(l,function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%",height:"100%"}},[t("div",{ref:"blocklyDiv",staticClass:"blocklyDiv",style:"height:".concat(this.$props.height)}),e._v(" "),e._m(0)],1)},[function(){return(0,this._self._c)("xml",{pre:!0,attrs:{ref:"blocklyToolbox",style:"display: none"}},[this._t("default")],2)}],!1,null,"1a7cf05c",null);t.default=component.exports},557:function(e,t,n){e.exports={}},571:function(e,t,n){"use strict";n(540)},576:function(e,t,n){"use strict";n.r(t);n(30),n(64);var o=n(551),r=(n(74),n(148),n(431),n(531)),l=n(572),c=n.n(l),d=200;function m(e,t){""===(t=t.split("#$"))[t.length-1]&&t.pop();var code=t=t.join("\n###"+e);return"("+(code=(code=code.replace(/ /g,"")).replace(/#/g," "))+")"}r.HSV_SATURATION=.3,r.HSV_VALUE=.8,r.defineBlocksWithJsonArray([{type:"data_type",message0:"資料 %1",args0:[{type:"field_input",name:"dataName",text:"price:收盤價"}],output:null,colour:230,tooltip:"",helpUrl:""},{type:"indicator",message0:"技術指標 %1",args0:[{type:"field_input",name:"dataName",text:"RSI(timeperiod=20)"}],output:null,colour:230,tooltip:"",helpUrl:""},{type:"df_rolling",message0:"近 %1 筆 %2 的 %3",args0:[{type:"field_number",name:"window",value:10},{type:"input_value",name:"df"},{type:"field_dropdown",name:"operation",options:[["平均","mean"],["總和","sum"],["最大值","max"],["最小值","min"]]}],inputsInline:!0,output:null,colour:200,tooltip:"",helpUrl:""},{type:"backtest",message0:"回測條件 %1 %2  %3 換股頻率 %4",args0:[{type:"field_dropdown",name:"operator",options:[["and","&"],["or","|"]]},{type:"input_dummy"},{type:"input_statement",name:"total_conditions"},{type:"field_dropdown",name:"rebalance_frequency",options:[["每日","D"],["每週","W"],["每月","M"],["每季","Q"]]}],inputsInline:!1,colour:0,tooltip:"",helpUrl:""},{type:"numerical_operator",message0:"%1 %2 %3 %4",args0:[{type:"input_value",name:"val_1"},{type:"field_dropdown",name:"operations",options:[["+","+"],["-","-"],["x","*"],["/","/"]]},{type:"input_dummy"},{type:"input_value",name:"val_2"}],inputsInline:!0,output:null,colour:d,tooltip:"",helpUrl:""},{type:"inequality",message0:"%1 %2 %3 %4",args0:[{type:"input_value",name:"val_1"},{type:"field_dropdown",name:"inequality",options:[[">",">"],["≥",">="],["<","<"],["≤","<="],["=","="]]},{type:"input_dummy"},{type:"input_value",name:"val_2"}],previousStatement:null,nextStatement:null,colour:d,tooltip:"",helpUrl:""},{type:"logic_conditions",message0:"%1 條件: %2 %3",args0:[{type:"field_dropdown",name:"operator",options:[["and","&&"],["or","||"]]},{type:"input_dummy"},{type:"input_statement",name:"Condition"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:50,tooltip:"",helpUrl:""},{type:"sort",message0:"%1 %2 %3",args0:[{type:"field_dropdown",name:"option",options:[["前","nlargest"],["後","nsmallest"]]},{type:"field_number",name:"threshold",value:10},{type:"field_dropdown",name:"unit",options:[["名","n"],["%","percent"]]}],message1:"%1",args1:[{type:"input_value",name:"value"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:200,tooltip:"",helpUrl:""},{type:"sort_condition",message0:"符合條件 %1 %2 %3",args0:[{type:"field_dropdown",name:"operator",options:[["And","&"],["Or","|"]]},{type:"input_dummy",name:"dummy"},{type:"input_statement",name:"statements"}],message1:"的股票中，數值 %1 排名 %2 %3 %4",args1:[{type:"input_value",name:"value"},{type:"field_dropdown",name:"option",options:[["前","nlargest"],["後","nsmallest"]]},{type:"field_number",name:"threshold",value:10},{type:"field_dropdown",name:"unit",options:[["名","n"],["%","percent"]]}],inputsInline:!1,previousStatement:null,nextStatement:null,colour:50,tooltip:"",helpUrl:""},{type:"shift",message0:"前 %1 筆 %2",args0:[{type:"field_number",name:"nshift",value:1,min:0},{type:"input_value",name:"df"}],inputsInline:!1,output:null,colour:d,tooltip:"",helpUrl:""}]),r.Python.sort_condition=function(e){var t=e.getFieldValue("option"),n=e.getFieldValue("threshold"),o=e.getFieldValue("unit"),l=r.Python.valueToCode(e,"value",r.Python.ORDER_ATOMIC),c=r.Python.statementToCode(e,"statements");c=m(e.getFieldValue("operator"),c);var code="(((".concat(l,") * (").concat(c,"))");return"nlargest"===t&&"n"===o?code+=".astype(float).is_largest("+n+"))":"nsmallest"===t&&"n"===o?code+=".astype(float).is_smallest("+n+"))":"nlargest"===t&&"percent"===o?code+=".rank(pct=True) > ".concat(n/100,"))"):"nsmallest"===t&&"percent"===o&&(code+=".rank(pct=True) < ".concat(n/100,"))")),code},r.Python.sort=function(e){var t=e.getFieldValue("option"),n=e.getFieldValue("threshold"),o=e.getFieldValue("unit"),l=r.Python.valueToCode(e,"value",r.Python.ORDER_ATOMIC),code="";return"nlargest"===t&&"n"===o?code=l+".is_largest("+n+")":"nsmallest"===t&&"n"===o?code=l+".is_smallest("+n+")":"nlargest"===t&&"percent"===o?code="("+l+".rank(pct=True) > ".concat(n/100,")"):"nsmallest"===t&&"percent"===o&&(code="("+l+".rank(pct=True) < ".concat(n/100,")")),code},r.Python.backtest=function(e){var t=e.getFieldValue("operator"),n=r.Python.statementToCode(e,"total_conditions"),o=(r.Python.valueToCode(e,"weight",r.Python.ORDER_ATOMIC),e.getFieldValue("rebalance_frequency")),code="from finlab import backtest\n";return code+="from finlab import data\n\n",code+="buy = "+m(t,n)+"\n\n",code+='backtest.sim(buy, resample="'+o+'")\n'},r.Python.df_rolling=function(e){var t=e.getFieldValue("window"),n=r.Python.valueToCode(e,"df",r.Python.ORDER_ATOMIC),o=e.getFieldValue("operation");return["(".concat(n,").rolling(").concat(t,").").concat(o,"()"),r.Python.ORDER_NONE]},r.Python.logic_conditions=function(e){return[m(e.getFieldValue("operator"),r.Python.statementToCode(e,"Condition")),r.Python.ORDER_NONE]},r.Python.data_type=function(e){var t=e.getFieldValue("dataName");return['data.get("'.concat(t,'")'),r.Python.ORDER_NONE]},r.Python.indicator=function(e){var t=e.getFieldValue("dataName"),n=t.split("(")[0],o=t.split("(")[1].replace(")","");return['data.indicator("'.concat(n,'", ').concat(o,")"),r.Python.ORDER_NONE]},r.Python.numerical_operator=function(e){var t=r.Python.valueToCode(e,"val_1",r.Python.ORDER_ATOMIC),n=e.getFieldValue("operations"),o=r.Python.valueToCode(e,"val_2",r.Python.ORDER_ATOMIC);return["(".concat(t).concat(n).concat(o,")"),r.Python.ORDER_NONE]},r.Python.inequality=function(e){var t=r.Python.valueToCode(e,"val_1",r.Python.ORDER_ATOMIC),n=e.getFieldValue("inequality"),o=r.Python.valueToCode(e,"val_2",r.Python.ORDER_ATOMIC);return"(".concat(t).concat(n).concat(o,")")+"#$"},r.Python.shift=function(e){var t=e.getFieldValue("nshift"),n=r.Python.valueToCode(e,"df",r.Python.ORDER_ATOMIC);return["(".concat(n,").shift(").concat(t,")"),r.Python.ORDER_NONE]};var f={name:"app",components:{BlocklyComponent:o.default},props:["value","height"],data:function(){return{xml:this.$props.value,code:"",options:{grid:{spacing:18,length:3,colour:"#ccc",snap:!1},zoom:{controls:!0,wheel:!0,startScale:.9,maxScale:3,minScale:.3,scaleSpeed:1.2},collapse:!0,toolboxPosition:"start",comments:!1,disable:!1,maxBlocks:1/0,trashcan:!0,horizontalLayout:!0,scrollbars:!0,sounds:!0,oneBasedIndex:!1,toolbox:'<xml xmlns="https://developers.google.com/blockly/xml" id="toolbox" style="display: none">\n    <block type="data_type">\n      <field name="NAME">price:收盤價</field>\n    </block>\n    <block type="indicator">\n      <field name="NAME"></field>\n    </block>\n    <block type="math_number">\n      <field name="NUM">0</field>\n    </block>\n    <block type="inequality">\n      <field name="inequality">&gt;</field>\n    </block>\n    <block type="numerical_operator">\n      <field name="operations">+</field>\n    </block>\n    <block type="df_rolling">\n      <field name="window">10</field>\n      <field name="operation">mean</field>\n    </block>\n    <block type="sort">\n      <field name="option">nlargest</field>\n      <field name="threshold">10</field>\n      <field name="unit">n</field>\n    </block>\n    <block type="shift">\n      <field name="nshift">1</field>\n    </block>\n    <block type="logic_conditions">\n      <field name="operator">&amp;&amp;</field>\n    </block>\n    <block type="sort_condition">\n      <field name="option">nlargest</field>\n      <field name="threshold">10</field>\n      <field name="unit">n</field>\n    </block>\n    <block type="backtest">\n      <field name="operator">&amp;=</field>\n      <field name="rebalance_frequency">D</field>\n    </block>\n  </xml>'}}},mounted:function(){this.injectCode(this.$props.value)},methods:{getCode:function(){return console.log("get py code"),this.code=c.a.workspaceToCode(this.$refs.foo.workspace),this.code=this.code.replace(/#\$/g,""),console.log(this.code),console.log("get py code done"),[this.code,this.$refs.foo.getCode()]},injectCode:function(e){this.$refs.foo.injectCode(e)},injectAdditionCode:function(e){this.$refs.foo.injectAdditionCode(e)}},beforeDestroy:function(){console.log("before destroy event");var code=this.$refs.foo.getCode();this.$emit("input",code)}},_=(n(619),n(52)),component=Object(_.a)(f,function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"app"}},[t("BlocklyComponent",{ref:"foo",attrs:{id:"blockly2",options:e.options,height:e.$props.height},model:{value:e.xml,callback:function(t){e.xml=t},expression:"xml"}})],1)},[],!1,null,null,null);t.default=component.exports;installComponents(component,{BlocklyComponent:n(551).default})},579:function(e,t,n){"use strict";n.r(t);n(39);var o=n(6),r=Object(o.b)({data:function(){return{tab:"財務數據",indicatorTables:[{functions:["HT_DCPERIOD","HT_DCPHASE","HT_PHASOR","HT_SINE","HT_TRENDMODE"],group:"Cycle Indicators"},{functions:["ADX(timeperiod=14)","ADXR(timeperiod=14)","APO(fastperiod=12, slowperiod=26, matype=0)","AROON(timeperiod=14)","AROONOSC(timeperiod=14)","BOP","CCI(timeperiod=14)","CMO(timeperiod=14)","DX(timeperiod=14)","MACD(fastperiod=12, slowperiod=26, signalperiod=9)","MACDEXT(fastperiod=12, fastmatype=0, slowperiod=26, slowmatype=0, signalperiod=9, signalmatype=0)","MACDFIX(signalperiod=9)","MFI(timeperiod=14)","MINUS_DI(timeperiod=14)","MINUS_DM(timeperiod=14)","MOM(timeperiod=10)","PLUS_DI(timeperiod=14)","PLUS_DM(timeperiod=14)","PPO(fastperiod=12, slowperiod=26, matype=0)","ROC(timeperiod=10)","ROCP(timeperiod=10)","ROCR(timeperiod=10)","ROCR100(timeperiod=10)","RSI(timeperiod=14)","STOCH(fastk_period=5, slowk_period=3, slowk_matype=0, slowd_period=3, slowd_matype=0)","STOCHF(fastk_period=5, fastd_period=3, fastd_matype=0)","STOCHRSI(timeperiod=14, fastk_period=5, fastd_period=3, fastd_matype=0)","TRIX(timeperiod=30)","ULTOSC(timeperiod1=7, timeperiod2=14, timeperiod3=28)","WILLR(timeperiod=14)"],group:"Momentum Indicators"},{functions:["BBANDS(timeperiod=5, nbdevup=2, nbdevdn=2, matype=0)","DEMA(timeperiod=30)","EMA(timeperiod=30)","HT_TRENDLINE","KAMA(timeperiod=30)","MA(timeperiod=30, matype=0)","MAMA(fastlimit=0.5, slowlimit=0.05)","MAVP(minperiod=2, maxperiod=30, matype=0)","MIDPOINT(timeperiod=14)","MIDPRICE(timeperiod=14)","SAR(acceleration=0.02, maximum=0.2)","SAREXT(startvalue=0, offsetonreverse=0, accelerationinitlong=0.02, accelerationlong=0.02, accelerationmaxlong=0.2, accelerationinitshort=0.02, accelerationshort=0.02, accelerationmaxshort=0.2)","SMA(timeperiod=30)","T3(timeperiod=5, vfactor=0.7)","TEMA(timeperiod=30)","TRIMA(timeperiod=30)","WMA(timeperiod=30)"],group:"Overlap Studies"},{functions:["CDL2CROWS","CDL3BLACKCROWS","CDL3INSIDE","CDL3LINESTRIKE","CDL3OUTSIDE","CDL3STARSINSOUTH","CDL3WHITESOLDIERS","CDLABANDONEDBABY(penetration=0.3)","CDLADVANCEBLOCK","CDLBELTHOLD","CDLBREAKAWAY","CDLCLOSINGMARUBOZU","CDLCONCEALBABYSWALL","CDLCOUNTERATTACK","CDLDARKCLOUDCOVER(penetration=0.5)","CDLDOJI","CDLDOJISTAR","CDLDRAGONFLYDOJI","CDLENGULFING","CDLEVENINGDOJISTAR(penetration=0.3)","CDLEVENINGSTAR(penetration=0.3)","CDLGAPSIDESIDEWHITE","CDLGRAVESTONEDOJI","CDLHAMMER","CDLHANGINGMAN","CDLHARAMI","CDLHARAMICROSS","CDLHIGHWAVE","CDLHIKKAKE","CDLHIKKAKEMOD","CDLHOMINGPIGEON","CDLIDENTICAL3CROWS","CDLINNECK","CDLINVERTEDHAMMER","CDLKICKING","CDLKICKINGBYLENGTH","CDLLADDERBOTTOM","CDLLONGLEGGEDDOJI","CDLLONGLINE","CDLMARUBOZU","CDLMATCHINGLOW","CDLMATHOLD(penetration=0.5)","CDLMORNINGDOJISTAR(penetration=0.3)","CDLMORNINGSTAR(penetration=0.3)","CDLONNECK","CDLPIERCING","CDLRICKSHAWMAN","CDLRISEFALL3METHODS","CDLSEPARATINGLINES","CDLSHOOTINGSTAR","CDLSHORTLINE","CDLSPINNINGTOP","CDLSTALLEDPATTERN","CDLSTICKSANDWICH","CDLTAKURI","CDLTASUKIGAP","CDLTHRUSTING","CDLTRISTAR","CDLUNIQUE3RIVER","CDLUPSIDEGAP2CROWS","CDLXSIDEGAP3METHODS"],group:"Pattern Recognition"},{functions:["AVGPRICE","MEDPRICE","TYPPRICE","WCLPRICE"],group:"Price Transform"},{functions:["BETA(timeperiod=5)","CORREL(timeperiod=30)","LINEARREG(timeperiod=14)","LINEARREG_ANGLE(timeperiod=14)","LINEARREG_INTERCEPT(timeperiod=14)","LINEARREG_SLOPE(timeperiod=14)","STDDEV(timeperiod=5, nbdev=1)","TSF(timeperiod=14)","VAR(timeperiod=5, nbdev=1)"],group:"Statistic Functions"},{functions:["ATR(timeperiod=14)","NATR(timeperiod=14)","TRANGE"],group:"Volatility Indicators"},{functions:["AD","ADOSC(fastperiod=3, slowperiod=10)","OBV"],group:"Volume Indicators"}],tables:[{columns:["成交股數","成交筆數","成交金額","收盤價","開盤價","最低價","最高價","最後揭示買價","最後揭示賣價"],name:"成交資訊",table_name:"price"},{columns:["殖利率(%)","本益比","股價淨值比"],name:"個股日本益比、殖利率及股價淨值比",table_name:"price_earning_ratio"},{columns:["當月營收","上月營收","去年當月營收","上月比較增減(%)","去年同月增減(%)","當月累計營收","去年累計營收","前期比較增減(%)"],name:"月營收",table_name:"monthly_revenue"},{columns:["前日借券餘額","借券","借券還券","借券增減","借券餘額"],name:"借券",table_name:"security_lending"},{columns:["借券賣出","借券賣出還券","借券賣出餘額","借券賣出限額"],name:"借券賣出",table_name:"security_lending_sell"},{columns:["現金及約當現金","透過損益按公允價值衡量之金融資產_流動","透過其他綜合損益按公允價值衡量之金融資產_流動","按攤銷後成本衡量之金融資產_流動","避險之金融資產_流動","合約資產_流動","應收帳款及票據","其他應收款","存貨","待出售非流動資產","當期所得稅資產_流動","其他流動資產","流動資產","透過損益按公允價值衡量之金融資產_非流動","透過其他綜合損益按公允價值衡量之金融資產_非流動","按攤銷後成本衡量之金融資產_非流動","避險之金融資產_非流動","合約資產_非流動","採權益法之長期股權投資","預付投資款","不動產廠房及設備","商譽及無形資產合計","遞延所得稅資產","遞延資產合計","使用權資產","投資性不動產淨額","其他非流動資產","非流動資產","資產總額","短期借款","應付商業本票∕承兌匯票","透過損益按公允價值衡量之金融負債_流動","避險之金融負債_流動","按攤銷後成本衡量之金融負債_流動","合約負債_流動","應付帳款及票據","其他應付款","當期所得稅負債","負債準備_流動","與待出售非流動資產直接相關之負債","租賃負債─流動","一年內到期長期負債","特別股負債_流動","流動負債","透過損益按公允價值衡量之金融負債_非流動","避險之金融負債_非流動","按攤銷後成本衡量之金融負債_非流動","合約負債_非流動","特別股負債_非流動","應付公司債_非流動","銀行借款_非流動","租賃負債_非流動","負債準備_非流動","遞延貸項","應計退休金負債","遞延所得稅","非流動負債","負債總額","普通股股本","特別股股本","預收股款","待分配股票股利","換股權利證書","股本","資本公積合計","法定盈餘公積","未分配盈餘","保留盈餘","其他權益","庫藏股票帳面值","母公司股東權益合計","共同控制下前手權益","合併前非屬共同控制股權","非控制權益","股東權益總額","負債及股東權益總額","營業收入淨額","營業成本","營業毛利","營業費用","研究發展費","推銷費用","管理費用","預期信用減損_損失_利益_營業費用","其他收益及費損淨額","營業利益","財務成本","採權益法之關聯企業及合資損益之份額","營業外收入及支出","稅前淨利","所得稅費用","繼續營業單位損益","停業單位損益","合併前非屬共同控制股權損益","合併總損益","本期綜合損益總額","歸屬母公司淨利_損","歸屬非控制權益淨利_損","歸屬共同控制下前手權益淨利_損","綜合損益歸屬母公司","綜合損益歸屬非控制權益","綜合損益歸屬共同控制下前手權益","每股盈餘","繼續營業單位稅前淨利_淨損","本期稅前淨利_淨損","折舊費用","攤銷費用","呆帳費用提列_轉列收入_數","透過損益按公允價值衡量金融資產及負債之淨損失_利益","利息費用","利息收入","股利收入","採用權益法認列之關聯企業及合資損失_利益_之份額","處分及報廢不動產_廠房及設備損失_利益","處分無形資產損失_利益","處分投資損失_利益","非金融資產減損迴轉利益","未實現銷貨利益_損失","已實現銷貨損失_利益","未實現外幣兌換損失_利益","收益費損項目合計","應收帳款_增加_減少","應收帳款_關係人_增加_減少","存貨_增加_減少","與營業活動相關之資產之淨變動合計","應付帳款增加_減少","應付帳款_關係人增加_減少","與營業活動相關之負債之淨變動合計","營運產生之現金流入_流出","退還_支付_之所得稅","營業活動之淨現金流入_流出","取得透過其他綜合損益按公允價值衡量之金融資產","處分透過其他綜合損益按公允價值衡量之金融資產","取得不動產_廠房及設備","處分不動產_廠房及設備","取得無形資產","處分無形資產","收取之利息","收取之股利","其他投資活動","投資活動之淨現金流入_流出","短期借款增加","短期借款減少","應付短期票券增加","應付短期票券減少","發行公司債","償還公司債","舉借長期借款","償還長期借款","存入保證金增加","存入保證金減少","發放現金股利","支付之利息","籌資活動之淨現金流入_流出","本期現金及約當現金增加_減少_數","期初現金及約當現金餘額","期末現金及約當現金餘額","資產負債表帳列之現金及約當現金"],name:"財報",table_name:"financial_statement"},{columns:["營業利益","營運現金流","歸屬母公司淨利","折舊","流動資產","流動負債","取得不動產廠房及設備","經常稅後淨利","ROA稅後息前","ROA綜合損益","ROE稅後","ROE綜合損益","稅前息前折舊前淨利率","營業毛利率","營業利益率","稅前淨利率","稅後淨利率","業外收支營收率","貝里比率","研究發展費用率","現金流量比率","稅率","每股營業額","每股營業利益","每股現金流量","每股稅前淨利","每股綜合損益","每股稅後淨利","總負債除總淨值","負債比率","淨值除資產","營收成長率","營業毛利成長率","營業利益成長率","稅前淨利成長率","稅後淨利成長率","經常利益成長率","資產總額成長率","淨值成長率","流動比率","速動比率","利息支出率","營運資金","總資產週轉次數","存貨週轉率","固定資產週轉次數","淨值週轉率次","自由現金流量"],name:"財務指標",table_name:"fundamental_features"}]}}}),l=n(52),component=Object(l.a)(r,function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticStyle:{padding:"10px",background:"rgba(250, 250, 255, 0.9)"}},[t("ul",{staticClass:"uk-child-width-expand",attrs:{"uk-tab":""}},[t("li",[t("a",{on:{click:function(t){e.tab="財務數據"}}},[e._v("財務數據")])]),e._v(" "),t("li",[t("a",{on:{click:function(t){e.tab="技術指標"}}},[e._v("技術指標")])])]),e._v(" "),"技術指標"===e.tab?t("ul",{staticClass:"uk-nav-default uk-nav-parent-icon",attrs:{"uk-nav":""}},e._l(e.indicatorTables,function(n){return t("li",{key:n.group,staticClass:"uk-parent"},[t("a",[e._v(e._s(n.group))]),e._v(" "),t("ul",{staticClass:"uk-nav-sub"},e._l(n.functions,function(i){return t("li",{key:n.group+i,on:{click:function(t){return e.$emit("selectIndicator",i)}}},[t("a",[e._v(e._s(i.split("(")[0]))])])}),0)])}),0):e._e(),e._v(" "),"財務數據"===e.tab?t("ul",{staticClass:"uk-nav-default uk-nav-parent-icon",attrs:{"uk-nav":""}},e._l(e.tables,function(n){return t("li",{key:n.name,staticClass:"uk-parent"},[t("a",[e._v(e._s(n.name))]),e._v(" "),t("ul",{staticClass:"uk-nav-sub"},e._l(n.columns,function(i){return t("li",{key:n.name+i,on:{click:function(t){return e.$emit("selectData",n.table_name+":"+i)}}},[t("a",[e._v(e._s(i))])])}),0)])}),0):e._e()])},[],!1,null,null,null);t.default=component.exports},619:function(e,t,n){"use strict";n(557)},625:function(e,t,n){e.exports={}},626:function(e,t,n){e.exports={}},685:function(e,t,n){e.exports=n.p+"img/loading.db1cd98.svg"},699:function(e,t,n){"use strict";n(625)},700:function(e,t,n){"use strict";n(626)},709:function(e,t,n){"use strict";n.r(t);n(570);var o=n(28),r=n(12),l=(n(43),n(74),n(65),n(148),n(588),n(279),n(23),n(30),n(86),n(45),n(54),n(66),n(67),n(53),n(40),n(64),n(590),n(591),n(592),n(593),n(594),n(595),n(597),n(598),n(599),n(600),n(601),n(602),n(603),n(56),n(38),n(87),n(57)),c=n(26),d=n(6),m=n(604),f=n(579),_=n(576);n(605),n(606),n(607),n(620);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach(function(t){Object(o.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var v=function(){return n.e(106).then(n.bind(null,809))},C=new(n(694))({fg:"#333"}),k=Object(d.b)({components:{codemirror:m.codemirror,DataSelector:f.default,BlocklyEditor:_.default},props:{sid:null,uid:null,viewmode:!1,codePredefined:null},data:function(){return{code:null,exampleCode:"from finlab import data\nfrom finlab.backtest import sim\n\n# 取得股價淨值比\npb = data.get('price_earning_ratio:股價淨值比')\n\n# 股價淨值比最小的10檔股票\nsmallest_pb = pb.is_smallest(10)\n\nsim(smallest_pb, resample='Q')",log:"",downloadFinished:!1,colabLink:null,localOutput:[],buildingColab:!1,localBacktest:!1,startCount:0,playCount:0,blockly:'<xml><block type="backtest"></block></xml>',openDatabasePanel:!1,editMode:"code",running:!1,timer:0,timerId:null,requestInverval:null,cmOptions:{autofocus:!0,tabSize:2,mode:"python",lineNumbers:!0,theme:"idle",line:!0,autoCloseBrackets:!0,scrollbarStyle:null,viewportMargin:1/0}}},mounted:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.setRealTimeUpdate(),e.localBacktest=!0,e.running=!0,t.next=1,Promise.all([e.download(),e.setupPyodide()]);case 1:case"end":return t.stop()}},t)}))()},methods:h(h({setupPyodide:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark(function t(){var n,o,r,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,v();case 1:return n=t.sent,o=e,n.setOutputCallBack(function(data){data instanceof Map&&(data=Object.fromEntries(data)),data.hasOwnProperty("id")&&(console.log("display",data),o.localOutput.push(data))}),e.running=!1,r="\nimport os\nimport finlab\nfrom finlab import data\nos.environ['FINLAB_FORCED_STRATEGY_NAME'] = \"".concat(e.sid,'"\nfinlab.login("').concat(e.$store.state.api_token,"#").concat(e.$store.state.role,'")\ndata.set_universe()'),t.next=2,n.asyncRun(r,{});case 2:l=t.sent,l.result,l.error;case 3:case"end":return t.stop()}},t)}))()},upload:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark(function t(){var n,o,r,code,l,d;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.uid&&e.sid){t.next=1;break}return t.abrupt("return");case 1:return e.log="上傳程式碼",n=c.c.collection("users").doc(e.uid).collection("strategies").doc(e.sid).collection("codes").doc("code"),o=null,r=e.blockly,void 0!==e.$refs.blocklyEditor&&(code=e.$refs.blocklyEditor.getCode(),o=code[0],r=code[1]),console.log("test 4",o),t.prev=2,l={code:e.code,blockly:r,blocklyCode:o,mode:e.editMode},t.next=3,n.set(l,{merge:!0});case 3:console.log(l),e.log="儲存成功",t.next=5;break;case 4:t.prev=4,d=t.catch(2),e.log="儲存失敗 "+d;case 5:case"end":return t.stop()}},t,null,[[2,4]])}))()},download:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark(function t(){var n,o,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.uid&&e.sid){t.next=1;break}return e.downloadFinished=!0,t.abrupt("return");case 1:return n=c.c.collection("users").doc(e.uid).collection("strategies").doc(e.sid).collection("codes").doc("code"),o=null,t.prev=2,t.next=3,n.get();case 3:o=t.sent,t.next=5;break;case 4:return t.prev=4,t.catch(2),e.downloadFinished=!0,t.abrupt("return");case 5:o&&o.exists?(r=o.data(),e.code=r.code||null,Array.isArray(e.code)&&(e.code=e.code[0]),r.blockly&&(e.blockly=r.blockly),!r.code&&r.ipynb&&(e.code=r.ipynb.join("\n")),"mode"in r&&(e.editMode=r.mode),e.log="下載程式碼成功! "):(e.log="找不到程式碼，幫你貼上範例!",e.code=e.exampleCode),e.downloadFinished=!0;case 6:case"end":return t.stop()}},t,null,[[2,4]])}))()},play:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark(function t(){var code,n,o,r,l,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.playCount+=1,e.running=!0,t.prev=1,t.next=2,e.upload();case 2:t.next=4;break;case 3:return t.prev=3,l=t.catch(1),e.log="上傳失敗 "+l,e.running=!1,t.abrupt("return");case 4:if(e.log="申請執行程式碼...",e.timer=0,!e.localBacktest){t.next=10;break}return code=e.code,n=!1,"blockly"===e.editMode&&(code=e.$refs.blocklyEditor.getCode()[0]),e.startTimer(),e.log="執行中",t.prev=5,console.log("start running pyodide"),console.log(code),e.localOutput=[],t.next=6,v();case 6:return o=t.sent,t.next=7,o.asyncRun(code,{});case 7:r=t.sent,console.log("execute end"),console.log(r),e.running=!1,e.log="執行結束 "+e.timer+"s",e.endTimer(),n=!0,t.next=9;break;case 8:t.prev=8,t.catch(5),e.running=!1,e.log="伺服器問題，執行結束 "+e.timer+"s",e.endTimer();case 9:if(!n){t.next=10;break}return t.abrupt("return");case 10:return t.abrupt("return");case 12:t.sent,e.startTimer(),t.next=14;break;case 13:return t.prev=13,c=t.catch(11),e.log="無法執行: "+c,e.running=!1,e.log="無法執行："+c.response.data.i+" "+c,e.cancelSimQueueRealtimeUpdate(),t.abrupt("return");case 14:e.setSimQueueRealTimeUpdate();case 15:case"end":return t.stop()}},t,null,[[1,3],[5,8],[11,13]])}))()},stopExecution:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=1,e.$axios.post("https://backtest.finlab.tw/del_job",{api_token:e.$store.state.api_token,sid:e.sid});case 1:t.sent,e.cancelSimQueueRealtimeUpdate(),e.running=!1,e.log="成功停止執行",e.endTimer(),t.next=3;break;case 2:t.prev=2,n=t.catch(0),log="cannot cancel execution"+n.response.data+" status "+n;case 3:case"end":return t.stop()}},t,null,[[0,2]])}))()},generate_colab_script:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark(function t(){var n,o,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.buildingColab=!0,n=["!pip install finlab -q",e.code],o=null,t.prev=1,t.next=2,e.$axios.post("https://asia-northeast1-fdata-299302.cloudfunctions.net/generate_colab_strategy",{sid:e.sid,uid:e.uid,code:JSON.stringify(n)});case 2:o=t.sent,t.next=4;break;case 3:return t.prev=3,r=t.catch(1),alert("upload colab fail: "+r.response.data+" "+r),console.log(r),t.abrupt("return");case 4:e.colabLink=o.data,e.buildingColab=!1;case 5:case"end":return t.stop()}},t,null,[[1,3]])}))()}},Object(l.b)({setRealTimeUpdate:"userInfo/setRealTimeUpdate",setSimQueueRealTimeUpdate:"simQueue/setRealTimeUpdate",cancelSimQueueRealtimeUpdate:"simQueue/cancelRealtimeUpdate"})),{},{convertToHtml:function(text){return C.toHtml(text)},startTimer:function(){this.timer=0;var e=this;this.timerId=setInterval(function(){e.timer=Math.round(10*(.1+e.timer))/10},100)},endTimer:function(){clearInterval(this.timerId),this.timerId=null},insertCodeEditor:function(text){var e=this.$refs.cmEditor.codemirror,t=e.getDoc(),cursor=t.getCursor();t.replaceRange(text,cursor),e.focus()},onSelectIndicator:function(text){if("code"===this.editMode)if(text.includes("(")){var e=text.split("(")[0],t=text.split("(")[1].replace(")","");this.insertCodeEditor('data.indicator("'.concat(e,'", ').concat(t,")"))}else this.insertCodeEditor('data.indicator("'.concat(text,'")'));else this.$refs.blocklyEditor.injectAdditionCode('<xml><block type="indicator"  x="50" y="50"><field name="dataName">'.concat(text,"</field></block></xml>"))},onSelectData:function(text){"code"===this.editMode?this.insertCodeEditor('data.get("'.concat(text,'")')):this.$refs.blocklyEditor.injectAdditionCode('<xml><block type="data_type"  x="50" y="50"><field name="dataName">'.concat(text,"</field></block></xml>"))}}),computed:h({output:function(){this.localOutput}},Object(l.c)({userInfo:"userInfo",simQueue:"simQueue"})),watch:{"simQueue.info":function(e,t){if(null===t&&this.simQueue&&(this.startCount=this.simQueue.info.count),console.log("watch!!!!",this.simQueue.info),this.userInfo.info.job.r)this.running=!1,this.log="執行結束 "+this.timer+"s",this.endTimer(),this.cancelSimQueueRealtimeUpdate();else{var n=this.userInfo.info.job.l+this.startCount-this.simQueue.info.count;this.log=0!==n?"尚須等待".concat(n,"人"):"執行中"}}}}),D=(n(699),n(700),n(52)),component=Object(D.a)(k,function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[null===e.$store.state.user?t("button",{staticClass:"uk-button uk-button-primary"},[e._v("\n    登入看程式碼\n  ")]):e._e(),e._v(" "),e.$store.state.user&&null===e.code&&e.downloadFinished?t("p",{staticClass:"uk-button uk-button-primary"},[e._v("\n    作者隱藏了程式碼\n  ")]):t("div",{staticClass:"shadow cm-container round-border",staticStyle:{"margin-bottom":"12px","z-index":"100",position:"relative"}},[t("div",{staticClass:"uk-position-relative dark-muted round-border"},[t("div",{staticClass:"uk-flex"},[t("div",{staticClass:"round-border",staticStyle:{padding:"6px","padding-right":"24px",cursor:"pointer","vertical-align":"middle","border-bottom-right-radius":"0","border-bottom-left-radius":"0","border-top-right-radius":"0"},style:{background:"code"===e.editMode?"white":""},on:{click:function(t){t.preventDefault(),e.editMode="code"}}},[t("a",{staticClass:"uk-icon-button",staticStyle:{background:"transparent"},attrs:{"uk-icon":"code"}}),e._v("\n          程式碼\n        ")]),e._v(" "),t("div",{staticStyle:{padding:"6px",cursor:"pointer","padding-right":"24px"},style:"blockly"===e.editMode?"background: white;":"",on:{click:function(t){t.preventDefault(),e.editMode="blockly"}}},[t("a",{staticClass:"uk-icon-button",staticStyle:{background:"transparent"},attrs:{"uk-icon":"thumbnails"}}),e._v("\n          策略拼圖\n        ")])]),e._v(" "),!1===e.$props.viewmode?t("div",{staticClass:"uk-position-top-right",on:{click:function(t){t.preventDefault(),e.openDatabasePanel=!e.openDatabasePanel}}},[e._m(0)]):e._e()]),e._v(" "),t("div",{staticStyle:{position:"relative"}},[e.openDatabasePanel&&!1===e.$props.viewmode?t("div",{staticStyle:{position:"absolute",width:"300px",top:"0",bottom:"0","margin-left":"calc(100% - 300px)","overflow-y":"scroll","overflow-x":"hidden","z-index":"4"}},[t("DataSelector",{on:{selectIndicator:e.onSelectIndicator,selectData:e.onSelectData}})],1):e._e(),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:"code"===e.editMode,expression:"editMode === 'code'"}],style:e.openDatabasePanel&&0==e.$props.viewmode?"margin-right: 300px;":""},[t("codemirror",{ref:"cmEditor",attrs:{options:e.cmOptions},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1),e._v(" "),"blockly"===e.editMode?t("BlocklyEditor",{ref:"blocklyEditor",model:{value:e.blockly,callback:function(t){e.blockly=t},expression:"blockly"}}):e._e()],1),e._v(" "),!1===e.$props.viewmode?t("div",{staticClass:"darker-primary round-border execute-btn",staticStyle:{padding:"10px","border-top-left-radius":"0","border-top-right-radius":"0"}},[t("a",{staticClass:"uk-icon-button",attrs:{"uk-icon":"upload"},on:{click:e.upload}}),e._v(" "),!1===e.running?t("a",{staticClass:"uk-icon-button",attrs:{"uk-icon":"play"},on:{click:e.play}}):t("a",{staticClass:"uk-icon-button",staticStyle:{cursor:"auto"}},[t("img",{attrs:{src:n(685),width:"40px"}})]),e._v(" "),e._v("\n      "+e._s(this.log)+"\n      "+e._s(null!==e.timerId?"\t"+e.timer.toFixed(1)+"s":"")+"\n    ")]):e._e()]),e._v(" "),0!==e.localOutput.length?t("div",{staticClass:"output uk-padding round-border",staticStyle:{"margin-top":"-48px","z-index":"1","padding-top":"48px"}},e._l(e.localOutput,function(n,i){return t("div",{key:"output"+i},["text"===n.type&&""!==n.content?t("div",[t("div",{staticClass:"uk-overflow-auto"},[t("div",[e._v("\n            "+e._s(n.content)+"\n          ")])])]):e._e(),e._v(" "),"html"===n.type?t("div",{staticClass:"uk-overflow-auto"},[t("div",{domProps:{innerHTML:e._s(n.content)}})]):e._e(),e._v(" "),"error"===n.type?t("div",{staticStyle:{"white-space":"pre"}},[t("div",{staticClass:"uk-overflow-auto"},[t("div",{domProps:{innerHTML:e._s(n.content)}})])]):e._e()])}),0):e._e()])},[function(){var e=this._self._c;this._self._setupProxy;return e("div",{staticClass:"uk-flex-right uk-margin-large-right",staticStyle:{"padding-top":"6px"}},[e("a",{staticClass:"uk-icon-button",attrs:{"uk-icon":"database"}})])}],!1,null,"0a39fe37",null);t.default=component.exports;installComponents(component,{DataSelector:n(579).default,BlocklyEditor:n(576).default})}}]);