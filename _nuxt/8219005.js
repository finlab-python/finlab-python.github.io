(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{898:function(t,e,l){"use strict";l.r(e);l(46),l(30),l(47),l(62),l(42),l(63);var o=l(25),n=l(8),r=(l(155),l(38),l(325)),c=l(15);function d(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(object);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,l)}return e}function v(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var y=Object(r.c)({data:function(){return{editMode:"create",editModes:["create","update"],courses:{},coursesID:[],coursesTitle:[],newPlaylist:{playlistName:"",description:"",permission:0,thumbnail:"",episodes:[{subtitle:""},{course_id:""}],display:!1},playlistData:{},oldPlaylistID:null,playlistsID:[],playlistName:[],pid:null,thumbnail:"",uploadProcessing:!1,DelProcessing:!1}},mounted:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var l,o,n,r,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.c.collection("courses").doc("menu").get();case 2:for(o in l=e.sent.data(),t.orgCourse=l,l)t.courses[l[o].cid]=l[o],t.coursesTitle.push(l[o].title),t.coursesID.push(l[o].cid);return e.next=7,c.c.collection("courses").doc("playlistMenu").get();case 7:for(r in n=e.sent.data(),t.playlistData=n,n)(d=n[r].playlistName)&&(t.playlistName.push(d),t.playlistsID.push(n[r].pid));t.$route.query.pid?(t.oldPlaylistID=t.$route.query.pid,t.editMode="update"):t.oldPlaylistID=t.playlistsID[0];case 11:case"end":return e.stop()}}),e)})))()},methods:{controlModeData:function(){var data="";return"create"==this.editMode?(data=this.newPlaylist,console.log(this.mode)):"update"==this.editMode&&(data=this.playlistData[this.oldPlaylistID]),data},moveUp:function(t){if(0!==t){var data=this.controlModeData(),e=t-1,l=v({},data.episodes[t]),o=v({},data.episodes[e]);this.$set(data.episodes,e,l),this.$set(data.episodes,t,o)}},moveDown:function(t){var data=this.controlModeData();if(t!==data.episodes.length-1){var e=t+1,l=v({},data.episodes[t]),o=v({},data.episodes[e]);this.$set(data.episodes,e,l),this.$set(data.episodes,t,o)}},addRow:function(t){try{this.controlModeData().episodes.splice(t+1,0,{})}catch(t){console.log(t)}},removeRow:function(t){this.controlModeData().episodes.splice(t,1)},upload:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var l,menu;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.uploadProcessing=!0,"create"!=t.editMode){e.next=14;break}return e.next=4,c.c.collection("courses").add(t.newPlaylist);case 4:return l=e.sent,t.pid=l.id,menu={},t.newPlaylist.pid=t.pid,menu[t.pid]=t.newPlaylist,e.next=12,c.c.collection("courses").doc("playlistMenu").set(menu,{merge:!0});case 12:e.next=18;break;case 14:if("update"!=t.editMode){e.next=18;break}return c.c.collection("courses").doc(t.oldPlaylistID).set(t.playlistData[t.oldPlaylistID]),e.next=18,c.c.collection("courses").doc("playlistMenu").set(t.playlistData,{merge:!0});case 18:t.uploadProcessing=!1;case 19:case"end":return e.stop()}}),e)})))()},del:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var menu;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t.oldPlaylistID){e.next=2;break}return e.abrupt("return");case 2:return t.DelProcessing=!0,e.next=5,c.c.collection("courses").doc(t.oldPlaylistID).delete();case 5:return e.next=7,c.c.collection("courses").doc("playlistMenu").get();case 7:delete(menu=e.sent.data())[t.oldPlaylistID],c.c.collection("courses").doc("playlistMenu").set(menu),t.DelProcessing=!1;case 11:case"end":return e.stop()}}),e)})))()}}}),m=l(40),component=Object(m.a)(y,(function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{staticClass:"uk-section uk-section-default"},[l("div",{staticClass:"uk-container"},[l("div",{staticClass:"swap-array-objects"},[l("h2",[t._v("Course Playlist Editor")]),t._v(" "),l("br"),t._v(" "),l("div",{staticClass:"uk-margin"},[l("div",{staticClass:"uk-margin"},[t._v("EditMode:")]),t._v(" "),l("select",{directives:[{name:"model",rawName:"v-model",value:t.editMode,expression:"editMode"}],staticClass:"uk-select",on:{change:function(e){var l=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.editMode=e.target.multiple?l:l[0]}}},t._l(t.editModes,(function(e,o){return l("option",{key:o},[t._v("\n            "+t._s(e)+"\n          ")])})),0)]),t._v(" "),l("div",{staticClass:"row"},["update"===this.editMode&&this.oldPlaylistID?l("div",{staticClass:"uk-margin"},[l("div",[t._v("PlaylistSelect:")]),t._v(" "),l("select",{directives:[{name:"model",rawName:"v-model",value:t.oldPlaylistID,expression:"oldPlaylistID"}],staticClass:"uk-select",on:{change:function(e){var l=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.oldPlaylistID=e.target.multiple?l:l[0]}}},t._l(t.playlistsID,(function(e,o){return l("option",{key:o,domProps:{value:e}},[t._v("\n              "+t._s(t.playlistData[e].playlistName)+"\n            ")])})),0)]):t._e(),t._v(" "),l("div",{staticClass:"uk-margin"},[l("div",{staticClass:"uk-margin"},[t._v("PlaylistName:")]),t._v(" "),"update"===this.editMode&&this.oldPlaylistID?l("div",[l("input",{directives:[{name:"model",rawName:"v-model",value:t.playlistData[t.oldPlaylistID].playlistName,expression:"playlistData[oldPlaylistID].playlistName"}],staticClass:"uk-input",domProps:{value:t.playlistData[t.oldPlaylistID].playlistName},on:{input:function(e){e.target.composing||t.$set(t.playlistData[t.oldPlaylistID],"playlistName",e.target.value)}}})]):t._e(),t._v(" "),"create"===this.editMode?l("div",[l("input",{directives:[{name:"model",rawName:"v-model",value:t.newPlaylist.playlistName,expression:"newPlaylist.playlistName"}],staticClass:"uk-input",domProps:{value:t.newPlaylist.playlistName},on:{input:function(e){e.target.composing||t.$set(t.newPlaylist,"playlistName",e.target.value)}}})]):t._e()]),t._v(" "),l("div",{staticClass:"uk-margin"},[l("div",{staticClass:"uk-margin"},[t._v("Description:")]),t._v(" "),"update"===this.editMode&&this.oldPlaylistID?l("div",[l("input",{directives:[{name:"model",rawName:"v-model",value:t.playlistData[t.oldPlaylistID].description,expression:"playlistData[oldPlaylistID].description"}],staticClass:"uk-input",domProps:{value:t.playlistData[t.oldPlaylistID].description},on:{input:function(e){e.target.composing||t.$set(t.playlistData[t.oldPlaylistID],"description",e.target.value)}}})]):t._e(),t._v(" "),"create"===this.editMode?l("div",[l("input",{directives:[{name:"model",rawName:"v-model",value:t.newPlaylist.description,expression:"newPlaylist.description"}],staticClass:"uk-input",domProps:{value:t.newPlaylist.description},on:{input:function(e){e.target.composing||t.$set(t.newPlaylist,"description",e.target.value)}}})]):t._e()]),t._v(" "),l("div",{staticClass:"uk-margin"},[l("div",{staticClass:"uk-margin"},[t._v("Thumbnail:")]),t._v(" "),"update"===this.editMode&&this.oldPlaylistID?l("div",[l("input",{directives:[{name:"model",rawName:"v-model",value:t.playlistData[t.oldPlaylistID].thumbnail,expression:"playlistData[oldPlaylistID].thumbnail"}],staticClass:"uk-input",domProps:{value:t.playlistData[t.oldPlaylistID].thumbnail},on:{input:function(e){e.target.composing||t.$set(t.playlistData[t.oldPlaylistID],"thumbnail",e.target.value)}}})]):t._e(),t._v(" "),"create"===this.editMode?l("div",[l("input",{directives:[{name:"model",rawName:"v-model",value:t.newPlaylist.thumbnail,expression:"newPlaylist.thumbnail"}],staticClass:"uk-input",domProps:{value:t.newPlaylist.thumbnail},on:{input:function(e){e.target.composing||t.$set(t.newPlaylist,"thumbnail",e.target.value)}}})]):t._e()]),t._v(" "),l("div",{staticClass:"uk-margin"},[l("div",{staticClass:"uk-margin"},[t._v("Permission:")]),t._v(" "),l("div",{staticClass:"uk-form-controls"},["update"===this.editMode&&this.oldPlaylistID?l("select",{directives:[{name:"model",rawName:"v-model",value:t.playlistData[t.oldPlaylistID].permission,expression:"playlistData[oldPlaylistID].permission"}],staticClass:"uk-select",on:{change:function(e){var l=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.playlistData[t.oldPlaylistID],"permission",e.target.multiple?l:l[0])}}},[l("option",{domProps:{value:0}},[t._v("所有用戶")]),t._v(" "),l("option",{domProps:{value:1}},[t._v("登入用戶")]),t._v(" "),l("option",{domProps:{value:2}},[t._v("VIP 月方案")]),t._v(" "),l("option",{domProps:{value:3}},[t._v("VIP 年方案")])]):t._e(),t._v(" "),"create"===this.editMode?l("select",{directives:[{name:"model",rawName:"v-model",value:t.newPlaylist.permission,expression:"newPlaylist.permission"}],staticClass:"uk-select",on:{change:function(e){var l=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.newPlaylist,"permission",e.target.multiple?l:l[0])}}},[l("option",{domProps:{value:0}},[t._v("所有用戶")]),t._v(" "),l("option",{domProps:{value:1}},[t._v("登入用戶")]),t._v(" "),l("option",{domProps:{value:2}},[t._v("VIP 月方案")]),t._v(" "),l("option",{domProps:{value:3}},[t._v("VIP 年方案")])]):t._e()])]),t._v(" "),l("div",{staticClass:"uk-margin"},[l("div",{staticClass:"uk-margin"},[t._v("Display:")]),t._v(" "),"update"===this.editMode&&this.oldPlaylistID?l("div",[l("input",{directives:[{name:"model",rawName:"v-model",value:t.playlistData[t.oldPlaylistID].display,expression:"playlistData[oldPlaylistID].display"}],staticClass:"uk-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.playlistData[t.oldPlaylistID].display)?t._i(t.playlistData[t.oldPlaylistID].display,null)>-1:t.playlistData[t.oldPlaylistID].display},on:{change:function(e){var l=t.playlistData[t.oldPlaylistID].display,o=e.target,n=!!o.checked;if(Array.isArray(l)){var r=t._i(l,null);o.checked?r<0&&t.$set(t.playlistData[t.oldPlaylistID],"display",l.concat([null])):r>-1&&t.$set(t.playlistData[t.oldPlaylistID],"display",l.slice(0,r).concat(l.slice(r+1)))}else t.$set(t.playlistData[t.oldPlaylistID],"display",n)}}})]):t._e(),t._v(" "),"create"===this.editMode?l("div",[l("input",{directives:[{name:"model",rawName:"v-model",value:t.newPlaylist.display,expression:"newPlaylist.display"}],staticClass:"uk-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.newPlaylist.display)?t._i(t.newPlaylist.display,null)>-1:t.newPlaylist.display},on:{change:function(e){var l=t.newPlaylist.display,o=e.target,n=!!o.checked;if(Array.isArray(l)){var r=t._i(l,null);o.checked?r<0&&t.$set(t.newPlaylist,"display",l.concat([null])):r>-1&&t.$set(t.newPlaylist,"display",l.slice(0,r).concat(l.slice(r+1)))}else t.$set(t.newPlaylist,"display",n)}}})]):t._e()]),t._v(" "),l("div",{staticClass:"uk-margin"},[l("br"),t._v(" "),l("div",{staticClass:"uk-margin"},[t._v("Episodes:")]),t._v(" "),l("table",{staticClass:"uk-table"},[t._m(0),t._v(" "),"update"===this.editMode&&this.oldPlaylistID?l("tbody",t._l(this.playlistData[this.oldPlaylistID].episodes,(function(e,o){return l("tr",{key:o},[l("td",[e.course_id?t._e():l("input",{directives:[{name:"model",rawName:"v-model",value:e.subtitle,expression:"item.subtitle"}],staticClass:"uk-input",domProps:{value:e.subtitle},on:{input:function(l){l.target.composing||t.$set(e,"subtitle",l.target.value)}}})]),t._v(" "),l("td",[e.subtitle?t._e():l("select",{directives:[{name:"model",rawName:"v-model",value:e.course_id,expression:"item.course_id"}],staticClass:"uk-select",on:{change:function(l){var o=Array.prototype.filter.call(l.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(e,"course_id",l.target.multiple?o:o[0])}}},t._l(t.coursesID,(function(e,o){return l("option",{key:o,domProps:{value:e}},[t._v("\n                      "+t._s(t.courses[e].title)+"\n                    ")])})),0)]),t._v(" "),l("td",[l("button",{staticClass:"uk-button uk-button-primary",on:{click:function(e){return t.moveUp(o)}}},[t._v("\n                    Up\n                  ")]),t._v(" "),l("button",{staticClass:"uk-button uk-button-primary",on:{click:function(e){return t.moveDown(o)}}},[t._v("\n                    Down\n                  ")]),t._v(" "),l("button",{staticClass:"uk-button uk-button-primary",on:{click:function(e){return t.addRow(o)}}},[t._v("\n                    add\n                  ")]),t._v(" "),l("button",{staticClass:"uk-button uk-button-primary",on:{click:function(e){return t.removeRow(o)}}},[t._v("\n                    remove\n                  ")])])])})),0):t._e(),t._v(" "),"create"===this.editMode?l("tbody",t._l(this.newPlaylist.episodes,(function(e,o){return l("tr",{key:o},[l("td",[e.course_id?t._e():l("input",{directives:[{name:"model",rawName:"v-model",value:e.subtitle,expression:"item.subtitle"}],staticClass:"uk-input",domProps:{value:e.subtitle},on:{input:function(l){l.target.composing||t.$set(e,"subtitle",l.target.value)}}})]),t._v(" "),l("td",[e.subtitle?t._e():l("select",{directives:[{name:"model",rawName:"v-model",value:e.course_id,expression:"item.course_id"}],staticClass:"uk-select",on:{change:function(l){var o=Array.prototype.filter.call(l.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(e,"course_id",l.target.multiple?o:o[0])}}},t._l(t.coursesID,(function(e,o){return l("option",{key:o,domProps:{value:e}},[t._v("\n                      "+t._s(t.courses[e].title)+"\n                    ")])})),0)]),t._v(" "),l("td",[l("button",{staticClass:"uk-button uk-button-primary",on:{click:function(e){return t.moveUp(o)}}},[t._v("\n                    Up\n                  ")]),t._v(" "),l("button",{staticClass:"uk-button uk-button-primary",on:{click:function(e){return t.moveDown(o)}}},[t._v("\n                    Down\n                  ")]),t._v(" "),l("button",{staticClass:"uk-button uk-button-primary",on:{click:function(e){return t.addRow(o)}}},[t._v("\n                    add\n                  ")]),t._v(" "),l("button",{staticClass:"uk-button uk-button-primary",on:{click:function(e){return t.removeRow(o)}}},[t._v("\n                    remove\n                  ")])])])})),0):t._e()]),t._v(" "),l("div",{staticClass:"uk-margin"},[l("button",{staticClass:"uk-button uk-button-primary",on:{click:t.upload}},[t._v("\n              "+t._s(t.uploadProcessing?"processing":"save")+"\n            ")]),t._v(" "),l("span",[l("button",{staticClass:"uk-button uk-button-primary uk-button-danger",on:{click:t.del}},[t._v("\n                "+t._s(t.DelProcessing?"processing":"delete")+"\n              ")])])])])]),t._v(" "),"update"===t.editMode?l("div",[t._v("\n        "+t._s(this.editMode)+" -- "+t._s(this.playlistData)+"\n      ")]):t._e(),t._v(" "),"create"===t.editMode?l("div",[t._v("\n        "+t._s(this.editMode)+" -- "+t._s(this.newPlaylist)+"\n      ")]):t._e()])])])}),[function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("thead",[l("tr",[l("th",[t._v("subtitle")]),t._v(" "),l("th",[t._v("course_id")]),t._v(" "),l("th",[t._v("edit")])])])}],!1,null,null,null);e.default=component.exports}}]);